
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>discretize.operators.DiffOperators.cell_gradient_z &#8212; discretize 0.10.1.dev118+ge3b5f01f documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../../_static/graphviz.css?v=4ae1632d" />
    <link rel="stylesheet" type="text/css" href="../../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery.css?v=d2d258e8" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-binder.css?v=f4aeca0c" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-dataframe.css?v=2082cf3c" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-rendered-html.css?v=1277b6f3" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/custom.css?v=6cad16a3" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../../_static/documentation_options.js?v=a74367b3"></script>
    <script src="../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'api/generated/discretize.operators.DiffOperators.cell_gradient_z';</script>
    <script>
        DOCUMENTATION_OPTIONS.theme_version = '0.15.4';
        DOCUMENTATION_OPTIONS.theme_switcher_json_url = 'https://discretize.simpeg.xyz/en/main/_static/versions.json';
        DOCUMENTATION_OPTIONS.theme_switcher_version_match = 'dev';
        DOCUMENTATION_OPTIONS.show_version_warning_banner = true;
        </script>
    <link rel="icon" href="../../_static/discretize-block.ico"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="discretize.operators.DiffOperators.edge_curl" href="discretize.operators.DiffOperators.edge_curl.html" />
    <link rel="prev" title="discretize.operators.DiffOperators.cell_gradient_y" href="discretize.operators.DiffOperators.cell_gradient_y.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class=" navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/discretize-logo.png" class="logo__image only-light" alt="discretize 0.10.1.dev118+ge3b5f01f documentation - Home"/>
    <script>document.write(`<img src="../../_static/discretize-logo.png" class="logo__image only-dark" alt="discretize 0.10.1.dev118+ge3b5f01f documentation - Home"/>`);</script>
  
  
</a></div>
    
  </div>
  
  <div class=" navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../content/getting_started.html">
    Getting Started
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../content/user_guide.html">
    User Guide
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="../index.html">
    API Reference
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../content/theory.html">
    Theory
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../release/index.html">
    Release Notes
  </a>
</li>

            <li class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-controls="pst-nav-more-links">
                    More
                </button>
                <ul id="pst-nav-more-links" class="dropdown-menu">
                    
<li class=" ">
  <a class="nav-link dropdown-item nav-external" href="https://simpeg.xyz">
    SimPEG
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-external" href="https://mattermost.softwareunderground.org/simpeg">
    Contact
  </a>
</li>

                </ul>
            </li>
            
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
        </div>
      
      
        <div class="navbar-item">
<script>
document.write(`
  <div class="version-switcher__container dropdown">
    <button id="pst-version-switcher-button-2"
      type="button"
      class="version-switcher__button btn btn-sm dropdown-toggle"
      data-bs-toggle="dropdown"
      aria-haspopup="listbox"
      aria-controls="pst-version-switcher-list-2"
      aria-label="Version switcher list"
    >
      Choose version  <!-- this text may get changed later by javascript -->
      <span class="caret"></span>
    </button>
    <div id="pst-version-switcher-list-2"
      class="version-switcher__menu dropdown-menu list-group-flush py-0"
      role="listbox" aria-labelledby="pst-version-switcher-button-2">
      <!-- dropdown will be populated by javascript on page load -->
    </div>
  </div>
`);
</script></div>
      
        <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/simpeg/simpeg" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fab fa-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://mattermost.softwareunderground.org/simpeg" title="Mattermost" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fas fa-comment fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Mattermost</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://simpeg.discourse.group/" title="Discourse" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fab fa-discourse fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Discourse</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://www.youtube.com/c/geoscixyz" title="Youtube" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fab fa-youtube fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Youtube</span></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../content/getting_started.html">
    Getting Started
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../content/user_guide.html">
    User Guide
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="../index.html">
    API Reference
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../content/theory.html">
    Theory
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../release/index.html">
    Release Notes
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-external" href="https://simpeg.xyz">
    SimPEG
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-external" href="https://mattermost.softwareunderground.org/simpeg">
    Contact
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">
<script>
document.write(`
  <div class="version-switcher__container dropdown">
    <button id="pst-version-switcher-button-3"
      type="button"
      class="version-switcher__button btn btn-sm dropdown-toggle"
      data-bs-toggle="dropdown"
      aria-haspopup="listbox"
      aria-controls="pst-version-switcher-list-3"
      aria-label="Version switcher list"
    >
      Choose version  <!-- this text may get changed later by javascript -->
      <span class="caret"></span>
    </button>
    <div id="pst-version-switcher-list-3"
      class="version-switcher__menu dropdown-menu list-group-flush py-0"
      role="listbox" aria-labelledby="pst-version-switcher-button-3">
      <!-- dropdown will be populated by javascript on page load -->
    </div>
  </div>
`);
</script></div>
        
          <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/simpeg/simpeg" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fab fa-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://mattermost.softwareunderground.org/simpeg" title="Mattermost" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fas fa-comment fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Mattermost</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://simpeg.discourse.group/" title="Discourse" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fab fa-discourse fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Discourse</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://www.youtube.com/c/geoscixyz" title="Youtube" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fab fa-youtube fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Youtube</span></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../discretize.html">Discretize Meshes (<code class="xref py py-mod docutils literal notranslate"><span class="pre">discretize</span></code>)</a></li>
</ul>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../discretize.base.html">Base Mesh (<code class="xref py py-mod docutils literal notranslate"><span class="pre">discretize.base</span></code>)</a></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../discretize.operators.html">Discrete Operators (<code class="xref py py-mod docutils literal notranslate"><span class="pre">discretize.operators</span></code>)</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2 current active has-children"><a class="reference internal" href="discretize.operators.DiffOperators.html">discretize.operators.DiffOperators</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="discretize.operators.DiffOperators.average_cell_to_edge.html">discretize.operators.DiffOperators.average_cell_to_edge</a></li>
<li class="toctree-l3"><a class="reference internal" href="discretize.operators.DiffOperators.average_cell_to_face.html">discretize.operators.DiffOperators.average_cell_to_face</a></li>
<li class="toctree-l3"><a class="reference internal" href="discretize.operators.DiffOperators.average_cell_vector_to_face.html">discretize.operators.DiffOperators.average_cell_vector_to_face</a></li>
<li class="toctree-l3"><a class="reference internal" href="discretize.operators.DiffOperators.average_edge_to_cell.html">discretize.operators.DiffOperators.average_edge_to_cell</a></li>
<li class="toctree-l3"><a class="reference internal" href="discretize.operators.DiffOperators.average_edge_to_cell_vector.html">discretize.operators.DiffOperators.average_edge_to_cell_vector</a></li>
<li class="toctree-l3"><a class="reference internal" href="discretize.operators.DiffOperators.average_edge_to_face.html">discretize.operators.DiffOperators.average_edge_to_face</a></li>
<li class="toctree-l3"><a class="reference internal" href="discretize.operators.DiffOperators.average_edge_x_to_cell.html">discretize.operators.DiffOperators.average_edge_x_to_cell</a></li>
<li class="toctree-l3"><a class="reference internal" href="discretize.operators.DiffOperators.average_edge_y_to_cell.html">discretize.operators.DiffOperators.average_edge_y_to_cell</a></li>
<li class="toctree-l3"><a class="reference internal" href="discretize.operators.DiffOperators.average_edge_z_to_cell.html">discretize.operators.DiffOperators.average_edge_z_to_cell</a></li>
<li class="toctree-l3"><a class="reference internal" href="discretize.operators.DiffOperators.average_face_to_cell.html">discretize.operators.DiffOperators.average_face_to_cell</a></li>
<li class="toctree-l3"><a class="reference internal" href="discretize.operators.DiffOperators.average_face_to_cell_vector.html">discretize.operators.DiffOperators.average_face_to_cell_vector</a></li>
<li class="toctree-l3"><a class="reference internal" href="discretize.operators.DiffOperators.average_face_x_to_cell.html">discretize.operators.DiffOperators.average_face_x_to_cell</a></li>
<li class="toctree-l3"><a class="reference internal" href="discretize.operators.DiffOperators.average_face_y_to_cell.html">discretize.operators.DiffOperators.average_face_y_to_cell</a></li>
<li class="toctree-l3"><a class="reference internal" href="discretize.operators.DiffOperators.average_face_z_to_cell.html">discretize.operators.DiffOperators.average_face_z_to_cell</a></li>
<li class="toctree-l3"><a class="reference internal" href="discretize.operators.DiffOperators.average_node_to_cell.html">discretize.operators.DiffOperators.average_node_to_cell</a></li>
<li class="toctree-l3"><a class="reference internal" href="discretize.operators.DiffOperators.average_node_to_edge.html">discretize.operators.DiffOperators.average_node_to_edge</a></li>
<li class="toctree-l3"><a class="reference internal" href="discretize.operators.DiffOperators.average_node_to_face.html">discretize.operators.DiffOperators.average_node_to_face</a></li>
<li class="toctree-l3"><a class="reference internal" href="discretize.operators.DiffOperators.boundary_edge_vector_integral.html">discretize.operators.DiffOperators.boundary_edge_vector_integral</a></li>
<li class="toctree-l3"><a class="reference internal" href="discretize.operators.DiffOperators.boundary_face_scalar_integral.html">discretize.operators.DiffOperators.boundary_face_scalar_integral</a></li>
<li class="toctree-l3"><a class="reference internal" href="discretize.operators.DiffOperators.boundary_node_vector_integral.html">discretize.operators.DiffOperators.boundary_node_vector_integral</a></li>
<li class="toctree-l3"><a class="reference internal" href="discretize.operators.DiffOperators.cellGrad.html">discretize.operators.DiffOperators.cellGrad</a></li>
<li class="toctree-l3"><a class="reference internal" href="discretize.operators.DiffOperators.cellGradBC.html">discretize.operators.DiffOperators.cellGradBC</a></li>
<li class="toctree-l3"><a class="reference internal" href="discretize.operators.DiffOperators.cellGradx.html">discretize.operators.DiffOperators.cellGradx</a></li>
<li class="toctree-l3"><a class="reference internal" href="discretize.operators.DiffOperators.cellGrady.html">discretize.operators.DiffOperators.cellGrady</a></li>
<li class="toctree-l3"><a class="reference internal" href="discretize.operators.DiffOperators.cellGradz.html">discretize.operators.DiffOperators.cellGradz</a></li>
<li class="toctree-l3"><a class="reference internal" href="discretize.operators.DiffOperators.cell_gradient.html">discretize.operators.DiffOperators.cell_gradient</a></li>
<li class="toctree-l3"><a class="reference internal" href="discretize.operators.DiffOperators.cell_gradient_BC.html">discretize.operators.DiffOperators.cell_gradient_BC</a></li>
<li class="toctree-l3"><a class="reference internal" href="discretize.operators.DiffOperators.cell_gradient_x.html">discretize.operators.DiffOperators.cell_gradient_x</a></li>
<li class="toctree-l3"><a class="reference internal" href="discretize.operators.DiffOperators.cell_gradient_y.html">discretize.operators.DiffOperators.cell_gradient_y</a></li>
<li class="toctree-l3 current active"><a class="current reference internal" href="#">discretize.operators.DiffOperators.cell_gradient_z</a></li>
<li class="toctree-l3"><a class="reference internal" href="discretize.operators.DiffOperators.edge_curl.html">discretize.operators.DiffOperators.edge_curl</a></li>
<li class="toctree-l3"><a class="reference internal" href="discretize.operators.DiffOperators.faceDivx.html">discretize.operators.DiffOperators.faceDivx</a></li>
<li class="toctree-l3"><a class="reference internal" href="discretize.operators.DiffOperators.faceDivy.html">discretize.operators.DiffOperators.faceDivy</a></li>
<li class="toctree-l3"><a class="reference internal" href="discretize.operators.DiffOperators.faceDivz.html">discretize.operators.DiffOperators.faceDivz</a></li>
<li class="toctree-l3"><a class="reference internal" href="discretize.operators.DiffOperators.face_divergence.html">discretize.operators.DiffOperators.face_divergence</a></li>
<li class="toctree-l3"><a class="reference internal" href="discretize.operators.DiffOperators.face_x_divergence.html">discretize.operators.DiffOperators.face_x_divergence</a></li>
<li class="toctree-l3"><a class="reference internal" href="discretize.operators.DiffOperators.face_y_divergence.html">discretize.operators.DiffOperators.face_y_divergence</a></li>
<li class="toctree-l3"><a class="reference internal" href="discretize.operators.DiffOperators.face_z_divergence.html">discretize.operators.DiffOperators.face_z_divergence</a></li>
<li class="toctree-l3"><a class="reference internal" href="discretize.operators.DiffOperators.nodal_gradient.html">discretize.operators.DiffOperators.nodal_gradient</a></li>
<li class="toctree-l3"><a class="reference internal" href="discretize.operators.DiffOperators.nodal_laplacian.html">discretize.operators.DiffOperators.nodal_laplacian</a></li>
<li class="toctree-l3"><a class="reference internal" href="discretize.operators.DiffOperators.project_edge_to_boundary_edge.html">discretize.operators.DiffOperators.project_edge_to_boundary_edge</a></li>
<li class="toctree-l3"><a class="reference internal" href="discretize.operators.DiffOperators.project_face_to_boundary_face.html">discretize.operators.DiffOperators.project_face_to_boundary_face</a></li>
<li class="toctree-l3"><a class="reference internal" href="discretize.operators.DiffOperators.project_node_to_boundary_node.html">discretize.operators.DiffOperators.project_node_to_boundary_node</a></li>
<li class="toctree-l3"><a class="reference internal" href="discretize.operators.DiffOperators.stencil_cell_gradient.html">discretize.operators.DiffOperators.stencil_cell_gradient</a></li>
<li class="toctree-l3"><a class="reference internal" href="discretize.operators.DiffOperators.stencil_cell_gradient_x.html">discretize.operators.DiffOperators.stencil_cell_gradient_x</a></li>
<li class="toctree-l3"><a class="reference internal" href="discretize.operators.DiffOperators.stencil_cell_gradient_y.html">discretize.operators.DiffOperators.stencil_cell_gradient_y</a></li>
<li class="toctree-l3"><a class="reference internal" href="discretize.operators.DiffOperators.stencil_cell_gradient_z.html">discretize.operators.DiffOperators.stencil_cell_gradient_z</a></li>
<li class="toctree-l3"><a class="reference internal" href="discretize.operators.DiffOperators.cell_gradient_weak_form_robin.html">discretize.operators.DiffOperators.cell_gradient_weak_form_robin</a></li>
<li class="toctree-l3"><a class="reference internal" href="discretize.operators.DiffOperators.edge_divergence_weak_form_robin.html">discretize.operators.DiffOperators.edge_divergence_weak_form_robin</a></li>
<li class="toctree-l3"><a class="reference internal" href="discretize.operators.DiffOperators.getBCProjWF.html">discretize.operators.DiffOperators.getBCProjWF</a></li>
<li class="toctree-l3"><a class="reference internal" href="discretize.operators.DiffOperators.getBCProjWF_simple.html">discretize.operators.DiffOperators.getBCProjWF_simple</a></li>
<li class="toctree-l3"><a class="reference internal" href="discretize.operators.DiffOperators.get_BC_projections.html">discretize.operators.DiffOperators.get_BC_projections</a></li>
<li class="toctree-l3"><a class="reference internal" href="discretize.operators.DiffOperators.get_BC_projections_simple.html">discretize.operators.DiffOperators.get_BC_projections_simple</a></li>
<li class="toctree-l3"><a class="reference internal" href="discretize.operators.DiffOperators.setCellGradBC.html">discretize.operators.DiffOperators.setCellGradBC</a></li>
<li class="toctree-l3"><a class="reference internal" href="discretize.operators.DiffOperators.set_cell_gradient_BC.html">discretize.operators.DiffOperators.set_cell_gradient_BC</a></li>
</ul>
</details></li>
<li class="toctree-l2"><a class="reference internal" href="discretize.operators.InnerProducts.html">discretize.operators.InnerProducts</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../discretize.mixins.html">Mixins (<code class="xref py py-mod docutils literal notranslate"><span class="pre">discretize.mixins</span></code>)</a></li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../discretize.utils.html">Utility Classes and Functions (<code class="xref py py-mod docutils literal notranslate"><span class="pre">discretize.utils</span></code>)</a></li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../discretize.tests.html">Testing Utilities (<code class="xref py py-mod docutils literal notranslate"><span class="pre">discretize.tests</span></code>)</a></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">





<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="../index.html" class="nav-link">API Reference</a></li>
    
    
    <li class="breadcrumb-item"><i class="fa-solid fa-ellipsis"></i></li>
    
    
    <li class="breadcrumb-item"><a href="discretize.operators.DiffOperators.html" class="nav-link">discretize.operators.DiffOperators</a></li>
    
    <li class="breadcrumb-item active" aria-current="page">discretize.o...</li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="discretize-operators-diffoperators-cell-gradient-z">
<h1>discretize.operators.DiffOperators.cell_gradient_z<a class="headerlink" href="#discretize-operators-diffoperators-cell-gradient-z" title="Link to this heading">#</a></h1>
<dl class="py property">
<dt class="sig sig-object py" id="discretize.operators.DiffOperators.cell_gradient_z">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">DiffOperators.</span></span><span class="sig-name descname"><span class="pre">cell_gradient_z</span></span><a class="headerlink" href="#discretize.operators.DiffOperators.cell_gradient_z" title="Link to this definition">#</a></dt>
<dd><p>Z-derivative operator (cell centers to z-faces).</p>
<p>This property constructs an z-derivative operator that acts on
cell centered quantities; i.e. the z-component of the cell gradient operator.
When applied, the z-derivative is mapped to z-faces. The operator is a
sparse matrix <span class="math notranslate nohighlight">\(\mathbf{G_z}\)</span> that can be applied as a matrix-vector
product to a cell centered quantity <span class="math notranslate nohighlight">\(\boldsymbol{\phi}\)</span>, i.e.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">grad_phi_z</span> <span class="o">=</span> <span class="n">Gz</span> <span class="o">@</span> <span class="n">phi</span>
</pre></div>
</div>
<p>By default, the operator assumes zero-Neumann boundary conditions
on the scalar quantity. Before calling <strong>cell_gradient_z</strong> however,
the user can set a mix of zero Dirichlet and zero Neumann boundary
conditions using <a class="reference internal" href="discretize.operators.DiffOperators.set_cell_gradient_BC.html#discretize.operators.DiffOperators.set_cell_gradient_BC" title="discretize.operators.DiffOperators.set_cell_gradient_BC"><code class="xref py py-attr docutils literal notranslate"><span class="pre">set_cell_gradient_BC</span></code></a>.
When <strong>cell_gradient_z</strong> is called, the boundary conditions are
enforced for the differencing operator.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>(<code class="xref py py-obj docutils literal notranslate"><span class="pre">n_faces_z</span></code>, <a class="reference internal" href="discretize.operators.DiffOperators.n_cells.html#discretize.operators.DiffOperators.n_cells" title="discretize.operators.DiffOperators.n_cells"><code class="xref py py-obj docutils literal notranslate"><span class="pre">n_cells</span></code></a>) <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.sparse.csr_matrix.html#scipy.sparse.csr_matrix" title="(in SciPy v1.14.1)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">scipy.sparse.csr_matrix</span></code></a></dt><dd><p>Z-derivative operator (z-component of the cell gradient)</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Below, we demonstrate how to set boundary conditions for the
z-component of the cell gradient, construct the operator and apply it
to a discrete scalar quantity. The mapping of the operator and
its sparsity is also illustrated.</p>
<p>We start by importing the necessary packages and modules.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">discretize</span> <span class="kn">import</span> <span class="n">TensorMesh</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">matplotlib</span> <span class="k">as</span> <span class="nn">mpl</span>
</pre></div>
</div>
<p>We then construct a mesh and define a scalar function at cell
centers.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">h</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">40</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mesh</span> <span class="o">=</span> <span class="n">TensorMesh</span><span class="p">([</span><span class="n">h</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">h</span><span class="p">],</span> <span class="s2">&quot;CCC&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">centers</span> <span class="o">=</span> <span class="n">mesh</span><span class="o">.</span><span class="n">cell_centers</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">phi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">centers</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="mi">8</span><span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<p>Before constructing the operator, we must define
the boundary conditions; zero Neumann for our example. Even though
we are only computing the derivative along z, we define boundary
conditions for all boundary faces. Once the
operator is created, it is applied as a matrix-vector product.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mesh</span><span class="o">.</span><span class="n">set_cell_gradient_BC</span><span class="p">([</span><span class="s1">&#39;neumann&#39;</span><span class="p">,</span> <span class="s1">&#39;neumann&#39;</span><span class="p">,</span> <span class="s1">&#39;neumann&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Gz</span> <span class="o">=</span> <span class="n">mesh</span><span class="o">.</span><span class="n">cell_gradient_z</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">grad_phi_z</span> <span class="o">=</span> <span class="n">Gz</span> <span class="o">@</span> <span class="n">phi</span>
</pre></div>
</div>
<p>Now we plot the original scalar and the z-derivative for a slice at y = 0.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">13</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">121</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mesh</span><span class="o">.</span><span class="n">plot_slice</span><span class="p">(</span><span class="n">phi</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax1</span><span class="p">,</span> <span class="n">normal</span><span class="o">=</span><span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="n">slice_loc</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Scalar at cell centers&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax2</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">122</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">mesh</span><span class="o">.</span><span class="n">nFx</span><span class="o">+</span><span class="n">mesh</span><span class="o">.</span><span class="n">nFy</span><span class="p">),</span> <span class="n">grad_phi_z</span><span class="p">]</span>  <span class="c1"># Define vector for plotting fun</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mesh</span><span class="o">.</span><span class="n">plot_slice</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax2</span><span class="p">,</span> <span class="n">v_type</span><span class="o">=</span><span class="s1">&#39;Fz&#39;</span><span class="p">,</span> <span class="n">normal</span><span class="o">=</span><span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="n">slice_loc</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Z-derivative (z-faces)&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference download internal" download="" href="../../_downloads/f63ecb52d240ad4aa2fe8e656afacb48/discretize-operators-DiffOperators-cell_gradient_z-1.py"><code class="xref download docutils literal notranslate"><span class="pre">Source</span> <span class="pre">code</span></code></a>, <a class="reference download internal" download="" href="../../_downloads/63e6d6dbcaa7c7a6fa4ee1500e009c58/discretize-operators-DiffOperators-cell_gradient_z-1_00_00.png"><code class="xref download docutils literal notranslate"><span class="pre">png</span></code></a>, <a class="reference download internal" download="" href="../../_downloads/2cdc903458001a5aef59b1e151a5d614/discretize-operators-DiffOperators-cell_gradient_z-1_00_00.pdf"><code class="xref download docutils literal notranslate"><span class="pre">pdf</span></code></a>)</p>
<figure class="align-default">
<img alt="../../_images/discretize-operators-DiffOperators-cell_gradient_z-1_00_00.png" class="plot-directive" src="../../_images/discretize-operators-DiffOperators-cell_gradient_z-1_00_00.png" />
</figure>
<p>The z-component cell gradient is a sparse derivative matrix
that maps from cell centers to z-faces. To demonstrate this, we provide
a spy plot</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax1</span><span class="o">.</span><span class="n">spy</span><span class="p">(</span><span class="n">mesh</span><span class="o">.</span><span class="n">cell_gradient_z</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Spy Plot&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Cell Index&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Z-Face Index&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference download internal" download="" href="../../_downloads/ced5ff7e1d035066342cab93f9993cfe/discretize-operators-DiffOperators-cell_gradient_z-1_01_00.png"><code class="xref download docutils literal notranslate"><span class="pre">png</span></code></a>, <a class="reference download internal" download="" href="../../_downloads/e32d02e3df31daa08d31097159036fc0/discretize-operators-DiffOperators-cell_gradient_z-1_01_00.pdf"><code class="xref download docutils literal notranslate"><span class="pre">pdf</span></code></a>)</p>
<figure class="align-default">
<img alt="../../_images/discretize-operators-DiffOperators-cell_gradient_z-1_01_00.png" class="plot-directive" src="../../_images/discretize-operators-DiffOperators-cell_gradient_z-1_01_00.png" />
</figure>
</dd></dl>

</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="discretize.operators.DiffOperators.cell_gradient_y.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">discretize.operators.DiffOperators.cell_gradient_y</p>
      </div>
    </a>
    <a class="right-next"
       href="discretize.operators.DiffOperators.edge_curl.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">discretize.operators.DiffOperators.edge_curl</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#discretize.operators.DiffOperators.cell_gradient_z"><code class="docutils literal notranslate"><span class="pre">DiffOperators.cell_gradient_z</span></code></a></li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">

  <div class="tocsection sourcelink">
    <a href="../../_sources/api/generated/discretize.operators.DiffOperators.cell_gradient_z.rst.txt">
      <i class="fa-solid fa-file-lines"></i> Show Source
    </a>
  </div>
</div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.15.4.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>