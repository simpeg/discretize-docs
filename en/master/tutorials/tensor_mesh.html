


<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Tensor meshes &mdash; discretize 0.4.5 documentation</title>
  

  
  
    <link rel="shortcut icon" href="../_static/logo-block.ico"/>
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/language_data.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/gallery.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Cylindrical meshes" href="cylindrical_mesh.html" />
    <link rel="prev" title="Overview of mesh types" href="mesh_overview.html" />
 

<meta name="description" content="Simulation and Parameter Estimation in Geophysics">
<meta name="author" content="SimPEG Developers">
<meta name="keywords" content="python, geophysics, inversion, electromagnetics, magnetotellurics, magnetics, gravity, DC, flow inverse problems, open source, finite volume">


<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-45185336-1', 'auto');
  ga('send', 'pageview');

</script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> discretize
          

          
          </a>

          
            
            
              <div class="version">
                0.4.5
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
    
            
            
              
            
            
              <p class="caption"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../content/big_picture.html">Why discretize?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../content/installing.html">Installing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gallery/index.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../content/additional_resources.html">Additional Resources</a></li>
</ul>
<p class="caption"><span class="caption-text">User Guide</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="mesh_overview.html">Overview of mesh types</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Tensor meshes</a></li>
<li class="toctree-l1"><a class="reference internal" href="cylindrical_mesh.html">Cylindrical meshes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../content/finite_volume.html">Finite Volume</a></li>
<li class="toctree-l1"><a class="reference internal" href="../content/inner_products.html">Inner Products</a></li>
</ul>
<p class="caption"><span class="caption-text">Reference documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../api/index.html">API Reference</a></li>
</ul>

            
          

    
        <p class="caption">
            <span class="caption-text">
            
                Getting connected
            
            </span>
        </p>
        <ul>
            
                <li class="toctree-l1"><a href="https://simpeg.xyz"><i class="fa fa-external-link-square fa-fw"></i> SimPEG</a></li>
            
                <li class="toctree-l1"><a href="http://slack.simpeg.xyz"><i class="fa fa-comment fa-fw"></i> Contact</a></li>
            
                <li class="toctree-l1"><a href="https://github.com/simpeg/discretize"><i class="fa fa-github fa-fw"></i> Source Code</a></li>
            
        </ul>
    

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">discretize</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
      <li>Tensor meshes</li>
    
    

    <li class="wy-breadcrumbs-aside">
        
            
                
                
                
                    
                
                <a href="https://github.com/simpeg/discretize/edit/master/doc/../tutorials/tensor_mesh.py"
                   class="fa fa-github"> Edit this page</a>
            
        
        
    </li>

  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast,
.nboutput.nblast {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast + .nbinput {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="sphx-glr-download-link-note admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Click <a class="reference internal" href="#sphx-glr-download-tutorials-tensor-mesh-py"><span class="std std-ref">here</span></a> to download the full example code</p>
</div>
<div class="sphx-glr-example-title section" id="tensor-meshes">
<span id="sphx-glr-tutorials-tensor-mesh-py"></span><h1>Tensor meshes<a class="headerlink" href="#tensor-meshes" title="Permalink to this headline">¶</a></h1>
<p>Tensor meshes (<a class="reference internal" href="../api/generated/discretize.TensorMesh.html#discretize.TensorMesh" title="discretize.TensorMesh"><code class="xref py py-class docutils literal notranslate"><span class="pre">TensorMesh</span></code></a>) are defined by a vectors of
cell widths in each dimension. They can be defined in 1, 2, or 3 dimensions.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">discretize</span>
</pre></div>
</div>
<p>In the simplest case, you can instantiate a tensor mesh by providing the
number of cells in each dimension. This assumes that the extent of each
dimension is unity.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ncx</span> <span class="o">=</span> <span class="mi">16</span>
<span class="n">ncy</span> <span class="o">=</span> <span class="mi">16</span>
<span class="n">tensor_mesh</span> <span class="o">=</span> <span class="n">discretize</span><span class="o">.</span><span class="n">TensorMesh</span><span class="p">([</span><span class="n">ncx</span><span class="p">,</span> <span class="n">ncy</span><span class="p">])</span>

<span class="n">tensor_mesh</span><span class="o">.</span><span class="n">plotGrid</span><span class="p">()</span>
</pre></div>
</div>
<img alt="../_images/sphx_glr_tensor_mesh_001.png" class="sphx-glr-single-img" src="../_images/sphx_glr_tensor_mesh_001.png" />
<p>If instead, you want a mesh that has 16 cells in each dimension and the width
of each cell is 1 (so that the extent of the domain is 16), you can instead
specify the vector of cell widths.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">hx2</span> <span class="o">=</span> <a href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ones.html#numpy.ones" title="View documentation for numpy.ones"><span class="n">np</span><span class="o">.</span><span class="n">ones</span></a><span class="p">(</span><span class="n">ncx</span><span class="p">)</span>
<span class="n">hy2</span> <span class="o">=</span> <a href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ones.html#numpy.ones" title="View documentation for numpy.ones"><span class="n">np</span><span class="o">.</span><span class="n">ones</span></a><span class="p">(</span><span class="n">ncy</span><span class="p">)</span>
<span class="n">tensor_mesh2</span> <span class="o">=</span> <span class="n">discretize</span><span class="o">.</span><span class="n">TensorMesh</span><span class="p">([</span><span class="n">hx2</span><span class="p">,</span> <span class="n">hy2</span><span class="p">])</span>

<span class="n">tensor_mesh2</span><span class="o">.</span><span class="n">plotGrid</span><span class="p">()</span>
</pre></div>
</div>
<img alt="../_images/sphx_glr_tensor_mesh_002.png" class="sphx-glr-single-img" src="../_images/sphx_glr_tensor_mesh_002.png" />
<p>In one lin, the above mesh can be specified by providing tuples to TensorMesh
(cell_size, number_of_cells)</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cell_size</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">tensor_mesh2b</span> <span class="o">=</span> <span class="n">discretize</span><span class="o">.</span><span class="n">TensorMesh</span><span class="p">([</span>
    <span class="p">[(</span><span class="n">cell_size</span><span class="p">,</span> <span class="n">ncx</span><span class="p">)],</span>  <span class="c1"># hx</span>
    <span class="p">[(</span><span class="n">cell_size</span><span class="p">,</span> <span class="n">ncy</span><span class="p">)]</span>  <span class="c1"># hy</span>
<span class="p">])</span>
</pre></div>
</div>
<p>The widths of the cells can be variable. For example when solving problems
in electromagnetics, it is necessary to add “padding cells” which expand
near the boundary so that we satisfy the boundary conditions</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">n_padding_cells</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">padding_factor</span> <span class="o">=</span> <span class="mf">1.3</span>
<span class="n">h_padding</span> <span class="o">=</span> <span class="n">padding_factor</span> <span class="o">*</span> <a href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.arange.html#numpy.arange" title="View documentation for numpy.arange"><span class="n">np</span><span class="o">.</span><span class="n">arange</span></a><span class="p">(</span><span class="n">n_padding_cells</span><span class="p">)</span>
<span class="n">h_core</span> <span class="o">=</span> <a href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ones.html#numpy.ones" title="View documentation for numpy.ones"><span class="n">np</span><span class="o">.</span><span class="n">ones</span></a><span class="p">(</span><span class="n">ncx</span><span class="p">)</span>

<span class="n">hx3</span> <span class="o">=</span> <a href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.hstack.html#numpy.hstack" title="View documentation for numpy.hstack"><span class="n">np</span><span class="o">.</span><span class="n">hstack</span></a><span class="p">([</span><a href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.flipud.html#numpy.flipud" title="View documentation for numpy.flipud"><span class="n">np</span><span class="o">.</span><span class="n">flipud</span></a><span class="p">(</span><span class="n">h_padding</span><span class="p">),</span> <span class="n">h_core</span><span class="p">,</span> <span class="n">h_padding</span><span class="p">])</span>
<span class="n">hy3</span> <span class="o">=</span> <span class="n">hx3</span>

<span class="n">tensor_mesh3</span> <span class="o">=</span> <span class="n">discretize</span><span class="o">.</span><span class="n">TensorMesh</span><span class="p">([</span><span class="n">hx3</span><span class="p">,</span> <span class="n">hy3</span><span class="p">])</span>

<span class="n">tensor_mesh3</span><span class="o">.</span><span class="n">plotGrid</span><span class="p">()</span>
</pre></div>
</div>
<img alt="../_images/sphx_glr_tensor_mesh_003.png" class="sphx-glr-single-img" src="../_images/sphx_glr_tensor_mesh_003.png" />
<p>Since it is common to include padding in meshes for numerical simulations,
we simplify the above steps by allowing you to provide a list of tuples
describing parts of the mesh. When there is a third number in the tuple, it
refers to the factor by which we increase the cell size. If the number is
negative, the tensor is flipped so that the widest cells are first.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">hx4</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">(</span><span class="n">cell_size</span><span class="p">,</span> <span class="n">n_padding_cells</span><span class="p">,</span> <span class="o">-</span><span class="n">padding_factor</span><span class="p">),</span>  <span class="c1"># padding on the left</span>
    <span class="p">(</span><span class="n">cell_size</span><span class="p">,</span> <span class="n">ncx</span><span class="p">),</span>  <span class="c1"># core part of the mesh (uniform cells)</span>
    <span class="p">(</span><span class="n">cell_size</span><span class="p">,</span> <span class="n">n_padding_cells</span><span class="p">,</span> <span class="n">padding_factor</span><span class="p">),</span>  <span class="c1"># padding on the right</span>
<span class="p">]</span>
<span class="n">hy4</span> <span class="o">=</span> <span class="n">hx4</span>
<span class="n">tensor_mesh4</span> <span class="o">=</span> <span class="n">discretize</span><span class="o">.</span><span class="n">TensorMesh</span><span class="p">([</span><span class="n">hx4</span><span class="p">,</span> <span class="n">hy4</span><span class="p">])</span>

<span class="n">tensor_mesh4</span><span class="o">.</span><span class="n">plotGrid</span><span class="p">()</span>
</pre></div>
</div>
<img alt="../_images/sphx_glr_tensor_mesh_004.png" class="sphx-glr-single-img" src="../_images/sphx_glr_tensor_mesh_004.png" />
<p>The origin of the mesh can be moved by assigning the <cite>x0</cite> variable. When a
mesh is instantiated, the <cite>x0</cite> can be provided as a keyword. Alternatively,
it can be set by setting the <cite>x0</cite> property after a mesh has been created.
Here, we will position the origin in the center of the mesh created in the
previous step.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">x0</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="n">tensor_mesh4</span><span class="o">.</span><span class="n">hx</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="n">tensor_mesh4</span><span class="o">.</span><span class="n">hy</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">/</span><span class="mi">2</span><span class="p">]</span>
<span class="n">tensor_mesh4</span><span class="o">.</span><span class="n">x0</span> <span class="o">=</span> <span class="n">x0</span>

<span class="n">tensor_mesh4</span><span class="o">.</span><span class="n">plotGrid</span><span class="p">()</span>
</pre></div>
</div>
<img alt="../_images/sphx_glr_tensor_mesh_005.png" class="sphx-glr-single-img" src="../_images/sphx_glr_tensor_mesh_005.png" />
<p>The above is equivalent to passing <cite>x0=’CC’</cite> which states that you want both
the x and y directions of the mesh to be centered. A ‘N’
will make the entire mesh negative, and a ‘0’ (or a 0) will
make the mesh start at zero.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">tensor_mesh4b</span> <span class="o">=</span> <span class="n">discretize</span><span class="o">.</span><span class="n">TensorMesh</span><span class="p">([</span><span class="n">hx4</span><span class="p">,</span> <span class="n">hx4</span><span class="p">],</span> <span class="n">x0</span><span class="o">=</span><span class="s1">&#39;CC&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">plotGrid</span><span class="p">()</span>
</pre></div>
</div>
<img alt="../_images/sphx_glr_tensor_mesh_006.png" class="sphx-glr-single-img" src="../_images/sphx_glr_tensor_mesh_006.png" />
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> ( 0 minutes  0.591 seconds)</p>
<div class="sphx-glr-footer class sphx-glr-footer-example docutils container" id="sphx-glr-download-tutorials-tensor-mesh-py">
<div class="sphx-glr-download docutils container">
<a class="reference download internal" download="" href="../_downloads/02e93ce5954331ef13acfb54896a571a/tensor_mesh.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">tensor_mesh.py</span></code></a></div>
<div class="sphx-glr-download docutils container">
<a class="reference download internal" download="" href="../_downloads/716ffb5fd9bbec93565f6204a576a892/tensor_mesh.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">tensor_mesh.ipynb</span></code></a></div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="cylindrical_mesh.html" class="btn btn-neutral float-right" title="Cylindrical meshes" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="mesh_overview.html" class="btn btn-neutral float-left" title="Overview of mesh types" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
<div role="contentinfo">
    <a rel="license" href="http://creativecommons.org/licenses/by/4.0/" width="60px"; style="float:right;height:3em;line-height:3em;padding:10px 0 0 1em;">
        <img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by/4.0/88x31.png" />
    </a>
    2013-2019,
    <a href="http://simpeg.xyz">SimPEG Developers.</a><br />
    Except where noted, this work is licensed under a <br />
    <a rel="license" href="http://creativecommons.org/licenses/by/4.0/">
        Creative Commons Attribution 4.0 International License
    </a>
</div>
<br>
<div>
Built with
    <a href="http://sphinx-doc.org/">Sphinx</a>
    using a
    <a href="https://github.com/snide/sphinx_rtd_theme">theme</a>
    provided by
    <a href="https://readthedocs.org">Read the Docs</a>.
 </div>


</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>