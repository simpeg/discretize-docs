


<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>discretize.View &mdash; discretize 0.4.4 documentation</title>
  

  
  
    <link rel="shortcut icon" href="../../_static/logo-block.ico"/>
  
  
  

  
  <script type="text/javascript" src="../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../_static/language_data.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/gallery.css" type="text/css" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
 

<meta name="description" content="Simulation and Parameter Estimation in Geophysics">
<meta name="author" content="SimPEG Developers">
<meta name="keywords" content="python, geophysics, inversion, electromagnetics, magnetotellurics, magnetics, gravity, DC, flow inverse problems, open source, finite volume">


<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-45185336-1', 'auto');
  ga('send', 'pageview');

</script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> discretize
          

          
          </a>

          
            
            
              <div class="version">
                0.4.4
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
    
            
            
              
            
            
              <p class="caption"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../content/big_picture.html">Why discretize?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../content/installing.html">Installing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../gallery/index.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../content/additional_resources.html">Additional Resources</a></li>
</ul>
<p class="caption"><span class="caption-text">User Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials/mesh_overview.html">Overview of mesh types</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials/tensor_mesh.html">Tensor meshes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials/cylindrical_mesh.html">Cylindrical meshes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../content/finite_volume.html">Finite Volume</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../content/inner_products.html">Inner Products</a></li>
</ul>
<p class="caption"><span class="caption-text">Reference documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../api/index.html">API Reference</a></li>
</ul>

            
          

    
        <p class="caption">
            <span class="caption-text">
            
                Getting connected
            
            </span>
        </p>
        <ul>
            
                <li class="toctree-l1"><a href="https://simpeg.xyz"><i class="fa fa-external-link-square fa-fw"></i> SimPEG</a></li>
            
                <li class="toctree-l1"><a href="http://slack.simpeg.xyz"><i class="fa fa-comment fa-fw"></i> Contact</a></li>
            
                <li class="toctree-l1"><a href="https://github.com/simpeg/discretize"><i class="fa fa-github fa-fw"></i> Source Code</a></li>
            
        </ul>
    

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">discretize</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../index.html">Module code</a> &raquo;</li>
        
      <li>discretize.View</li>
    
    

    <li class="wy-breadcrumbs-aside">
        
        
    </li>

  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for discretize.View</h1><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">__future__</span> <span class="k">import</span> <span class="n">print_function</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="kn">from</span> <span class="nn">discretize.utils</span> <span class="k">import</span> <span class="n">mkvc</span><span class="p">,</span> <span class="n">ndgrid</span>
<span class="kn">from</span> <span class="nn">discretize.utils.codeutils</span> <span class="k">import</span> <span class="n">requires</span>
<span class="kn">from</span> <span class="nn">six</span> <span class="k">import</span> <span class="n">integer_types</span>

<span class="c1"># matplotlib is a soft dependencies for discretize</span>
<span class="k">try</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">matplotlib</span>
    <span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
    <span class="kn">from</span> <span class="nn">matplotlib.widgets</span> <span class="k">import</span> <span class="n">Slider</span>
    <span class="kn">from</span> <span class="nn">mpl_toolkits.mplot3d</span> <span class="k">import</span> <span class="n">Axes3D</span>
    <span class="kn">import</span> <span class="nn">matplotlib.colors</span> <span class="k">as</span> <span class="nn">colors</span>
    <span class="kn">import</span> <span class="nn">matplotlib.cm</span> <span class="k">as</span> <span class="nn">cmx</span>
<span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
    <span class="n">matplotlib</span> <span class="o">=</span> <span class="kc">False</span>


<div class="viewcode-block" id="TensorView"><a class="viewcode-back" href="../../api/generated/discretize.View.TensorView.html#discretize.TensorView">[docs]</a><span class="nd">@requires</span><span class="p">({</span><span class="s1">&#39;matplotlib&#39;</span><span class="p">:</span> <span class="n">matplotlib</span><span class="p">})</span>
<span class="k">class</span> <span class="nc">TensorView</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Provides viewing functions for TensorMesh</span>

<span class="sd">    This class is inherited by TensorMesh</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">pass</span>

    <span class="c1"># def components(self):</span>

    <span class="c1">#     plotAll = len(imageType) == 1</span>
    <span class="c1">#     options = {&quot;direction&quot;:direction, &quot;numbering&quot;:numbering, &quot;annotationColor&quot;:annotationColor, &quot;showIt&quot;:False}</span>
    <span class="c1">#     fig = plt.figure(figNum)</span>
    <span class="c1">#     # Determine the subplot number: 131, 121</span>
    <span class="c1">#     numPlots = 130 if plotAll else len(imageType)//2*10+100</span>
    <span class="c1">#     pltNum = 1</span>
    <span class="c1">#     fxyz = self.r(I, &#39;F&#39;, &#39;F&#39;, &#39;M&#39;)</span>
    <span class="c1">#     if plotAll or &#39;Fx&#39; in imageType:</span>
    <span class="c1">#         ax_x = plt.subplot(numPlots+pltNum)</span>
    <span class="c1">#         self.plotImage(fxyz[0], imageType=&#39;Fx&#39;, ax=ax_x, **options)</span>
    <span class="c1">#         pltNum +=1</span>
    <span class="c1">#     if plotAll or &#39;Fy&#39; in imageType:</span>
    <span class="c1">#         ax_y = plt.subplot(numPlots+pltNum)</span>
    <span class="c1">#         self.plotImage(fxyz[1], imageType=&#39;Fy&#39;, ax=ax_y, **options)</span>
    <span class="c1">#         pltNum +=1</span>
    <span class="c1">#     if plotAll or &#39;Fz&#39; in imageType:</span>
    <span class="c1">#         ax_z = plt.subplot(numPlots+pltNum)</span>
    <span class="c1">#         self.plotImage(fxyz[2], imageType=&#39;Fz&#39;, ax=ax_z, **options)</span>
    <span class="c1">#         pltNum +=1</span>
    <span class="c1">#     if showIt: plt.show()</span>

<div class="viewcode-block" id="TensorView.plotImage"><a class="viewcode-back" href="../../api/generated/discretize.View.TensorView.html#discretize.TensorView.plotImage">[docs]</a>    <span class="k">def</span> <span class="nf">plotImage</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">vType</span><span class="o">=</span><span class="s1">&#39;CC&#39;</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">view</span><span class="o">=</span><span class="s1">&#39;real&#39;</span><span class="p">,</span>
        <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">clim</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">showIt</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">pcolorOpts</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">streamOpts</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">gridOpts</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">numbering</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">annotationColor</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">,</span>
        <span class="n">range_x</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">range_y</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">sample_grid</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">stream_threshold</span><span class="o">=</span><span class="kc">None</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Mesh.plotImage(v)</span>

<span class="sd">        Plots scalar fields on the given mesh.</span>

<span class="sd">        Input:</span>

<span class="sd">        :param numpy.ndarray v: vector</span>

<span class="sd">        Optional Inputs:</span>

<span class="sd">        :param str vType: type of vector (&#39;CC&#39;, &#39;N&#39;, &#39;F&#39;, &#39;Fx&#39;, &#39;Fy&#39;, &#39;Fz&#39;, &#39;E&#39;, &#39;Ex&#39;, &#39;Ey&#39;, &#39;Ez&#39;)</span>
<span class="sd">        :param matplotlib.axes.Axes ax: axis to plot to</span>
<span class="sd">        :param bool showIt: call plt.show()</span>

<span class="sd">        3D Inputs:</span>

<span class="sd">        :param bool numbering: show numbering of slices, 3D only</span>
<span class="sd">        :param str annotationColor: color of annotation, e.g. &#39;w&#39;, &#39;k&#39;, &#39;b&#39;</span>

<span class="sd">        .. plot::</span>
<span class="sd">            :include-source:</span>

<span class="sd">            import discretize</span>
<span class="sd">            import numpy as np</span>
<span class="sd">            M = discretize.TensorMesh([20, 20])</span>
<span class="sd">            v = np.sin(M.gridCC[:, 0]*2*np.pi)*np.sin(M.gridCC[:, 1]*2*np.pi)</span>
<span class="sd">            M.plotImage(v, showIt=True)</span>

<span class="sd">        .. plot::</span>
<span class="sd">            :include-source:</span>

<span class="sd">            import discretize</span>
<span class="sd">            import numpy as np</span>
<span class="sd">            M = discretize.TensorMesh([20, 20, 20])</span>
<span class="sd">            v = np.sin(M.gridCC[:, 0]*2*np.pi)*np.sin(M.gridCC[:, 1]*2*np.pi)*np.sin(M.gridCC[:, 2]*2*np.pi)</span>
<span class="sd">            M.plotImage(v, annotationColor=&#39;k&#39;, showIt=True)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">pcolorOpts</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">pcolorOpts</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">if</span> <span class="n">streamOpts</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">streamOpts</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;k&#39;</span><span class="p">}</span>
        <span class="k">if</span> <span class="n">gridOpts</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">gridOpts</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;k&#39;</span><span class="p">}</span>

        <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
            <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">Axes</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">AssertionError</span><span class="p">(</span><span class="s2">&quot;ax must be an Axes!&quot;</span><span class="p">)</span>
            <span class="n">fig</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">figure</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dim</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">vType</span> <span class="o">==</span> <span class="s1">&#39;CC&#39;</span><span class="p">:</span>
                <span class="n">ph</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">vectorCCx</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;C1&quot;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;o&quot;</span>
                <span class="p">)</span>
            <span class="k">elif</span> <span class="n">vType</span> <span class="o">==</span> <span class="s1">&#39;N&#39;</span><span class="p">:</span>
                <span class="n">ph</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">vectorNx</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;C0&quot;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;s&quot;</span>
                <span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">dim</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_plotImage2D</span><span class="p">(</span>
                <span class="n">v</span><span class="p">,</span> <span class="n">vType</span><span class="o">=</span><span class="n">vType</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="n">grid</span><span class="p">,</span> <span class="n">view</span><span class="o">=</span><span class="n">view</span><span class="p">,</span>
                <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">clim</span><span class="o">=</span><span class="n">clim</span><span class="p">,</span> <span class="n">showIt</span><span class="o">=</span><span class="n">showIt</span><span class="p">,</span>
                <span class="n">pcolorOpts</span><span class="o">=</span><span class="n">pcolorOpts</span><span class="p">,</span> <span class="n">streamOpts</span><span class="o">=</span><span class="n">streamOpts</span><span class="p">,</span>
                <span class="n">gridOpts</span><span class="o">=</span><span class="n">gridOpts</span><span class="p">,</span> <span class="n">range_x</span><span class="o">=</span><span class="n">range_x</span><span class="p">,</span> <span class="n">range_y</span><span class="o">=</span><span class="n">range_y</span><span class="p">,</span>
                <span class="n">sample_grid</span><span class="o">=</span><span class="n">sample_grid</span><span class="p">,</span> <span class="n">stream_threshold</span><span class="o">=</span><span class="n">stream_threshold</span>
            <span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">dim</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
            <span class="c1"># get copy of image and average to cell-centers is necessary</span>
            <span class="k">if</span> <span class="n">vType</span> <span class="o">==</span> <span class="s1">&#39;CC&#39;</span><span class="p">:</span>
                <span class="n">vc</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vnC</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="s1">&#39;F&#39;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">vType</span> <span class="o">==</span> <span class="s1">&#39;N&#39;</span><span class="p">:</span>
                <span class="n">vc</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">aveN2CC</span><span class="o">*</span><span class="n">v</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vnC</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="s1">&#39;F&#39;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">vType</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;Fx&#39;</span><span class="p">,</span> <span class="s1">&#39;Fy&#39;</span><span class="p">,</span> <span class="s1">&#39;Fz&#39;</span><span class="p">,</span> <span class="s1">&#39;Ex&#39;</span><span class="p">,</span> <span class="s1">&#39;Ey&#39;</span><span class="p">,</span> <span class="s1">&#39;Ez&#39;</span><span class="p">]:</span>
                <span class="n">aveOp</span> <span class="o">=</span> <span class="s1">&#39;ave&#39;</span> <span class="o">+</span> <span class="n">vType</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;2CCV&#39;</span>
                <span class="c1"># n = getattr(self, &#39;vn&#39;+vType[0])</span>
                <span class="c1"># if &#39;x&#39; in vType: v = np.r_[v, np.zeros(n[1]), np.zeros(n[2])]</span>
                <span class="c1"># if &#39;y&#39; in vType: v = np.r_[np.zeros(n[0]), v, np.zeros(n[2])]</span>
                <span class="c1"># if &#39;z&#39; in vType: v = np.r_[np.zeros(n[0]), np.zeros(n[1]), v]</span>
                <span class="n">v</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">aveOp</span><span class="p">)</span><span class="o">*</span><span class="n">v</span> <span class="c1"># average to cell centers</span>
                <span class="n">ind_xyz</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;z&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">}[</span><span class="n">vType</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
                <span class="n">vc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="p">(</span>
                    <span class="n">v</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">nC</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">order</span><span class="o">=</span><span class="s1">&#39;F&#39;</span><span class="p">),</span> <span class="s1">&#39;CC&#39;</span><span class="p">,</span> <span class="s1">&#39;CC&#39;</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span>
                <span class="p">)[</span><span class="n">ind_xyz</span><span class="p">]</span>

            <span class="c1"># determine number oE slices in x and y dimension</span>
            <span class="n">nX</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nCz</span><span class="p">)))</span>
            <span class="n">nY</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nCz</span><span class="o">/</span><span class="n">nX</span><span class="p">))</span>

            <span class="c1">#  allocate space for montage</span>
            <span class="n">nCx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nCx</span>
            <span class="n">nCy</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nCy</span>

            <span class="n">C</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nX</span><span class="o">*</span><span class="n">nCx</span><span class="p">,</span> <span class="n">nY</span><span class="o">*</span><span class="n">nCy</span><span class="p">))</span>

            <span class="k">for</span> <span class="n">iy</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">nY</span><span class="p">)):</span>
                <span class="k">for</span> <span class="n">ix</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">nX</span><span class="p">)):</span>
                    <span class="n">iz</span> <span class="o">=</span> <span class="n">ix</span> <span class="o">+</span> <span class="n">iy</span><span class="o">*</span><span class="n">nX</span>
                    <span class="k">if</span> <span class="n">iz</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">nCz</span><span class="p">:</span>
                        <span class="n">C</span><span class="p">[</span><span class="n">ix</span><span class="o">*</span><span class="n">nCx</span><span class="p">:(</span><span class="n">ix</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">nCx</span><span class="p">,</span> <span class="n">iy</span><span class="o">*</span><span class="n">nCy</span><span class="p">:(</span><span class="n">iy</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">nCy</span><span class="p">]</span> <span class="o">=</span> <span class="n">vc</span><span class="p">[:,</span> <span class="p">:,</span> <span class="n">iz</span><span class="p">]</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">C</span><span class="p">[</span><span class="n">ix</span><span class="o">*</span><span class="n">nCx</span><span class="p">:(</span><span class="n">ix</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">nCx</span><span class="p">,</span> <span class="n">iy</span><span class="o">*</span><span class="n">nCy</span><span class="p">:(</span><span class="n">iy</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">nCy</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>

            <span class="n">C</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">masked_where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">C</span><span class="p">),</span> <span class="n">C</span><span class="p">)</span>
            <span class="n">xx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">kron</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="n">nX</span><span class="p">,</span> <span class="mi">1</span><span class="p">)),</span> <span class="bp">self</span><span class="o">.</span><span class="n">hx</span><span class="p">)</span><span class="o">.</span><span class="n">ravel</span><span class="p">())]</span>
            <span class="n">yy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">kron</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="n">nY</span><span class="p">,</span> <span class="mi">1</span><span class="p">)),</span> <span class="bp">self</span><span class="o">.</span><span class="n">hy</span><span class="p">)</span><span class="o">.</span><span class="n">ravel</span><span class="p">())]</span>
            <span class="c1"># Plot the mesh</span>

            <span class="k">if</span> <span class="n">clim</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">clim</span> <span class="o">=</span> <span class="p">[</span><span class="n">C</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">C</span><span class="o">.</span><span class="n">max</span><span class="p">()]</span>
            <span class="n">ph</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span> <span class="n">yy</span><span class="p">,</span> <span class="n">C</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="n">clim</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">vmax</span><span class="o">=</span><span class="n">clim</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
            <span class="c1"># Plot the lines</span>
            <span class="n">gx</span> <span class="o">=</span>  <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">nX</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vectorNx</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">x0</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">gy</span> <span class="o">=</span>  <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">nY</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vectorNy</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">x0</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
            <span class="c1"># Repeat and seperate with NaN</span>
            <span class="n">gxX</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">c_</span><span class="p">[</span><span class="n">gx</span><span class="p">,</span> <span class="n">gx</span><span class="p">,</span> <span class="n">gx</span><span class="o">+</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">]</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
            <span class="n">gxY</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">kron</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="n">nX</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="nb">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">hy</span><span class="p">)</span><span class="o">*</span><span class="n">nY</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">]))</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
            <span class="n">gyX</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">kron</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="n">nY</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="nb">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">hx</span><span class="p">)</span><span class="o">*</span><span class="n">nX</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">]))</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
            <span class="n">gyY</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">c_</span><span class="p">[</span><span class="n">gy</span><span class="p">,</span> <span class="n">gy</span><span class="p">,</span> <span class="n">gy</span><span class="o">+</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">]</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">gxX</span><span class="p">,</span> <span class="n">gxY</span><span class="p">,</span> <span class="n">annotationColor</span><span class="o">+</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">gyX</span><span class="p">,</span> <span class="n">gyY</span><span class="p">,</span> <span class="n">annotationColor</span><span class="o">+</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">numbering</span><span class="p">:</span>
                <span class="n">pad</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">hx</span><span class="p">)</span><span class="o">*</span><span class="mf">0.04</span>
                <span class="k">for</span> <span class="n">iy</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">nY</span><span class="p">)):</span>
                    <span class="k">for</span> <span class="n">ix</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">nX</span><span class="p">)):</span>
                        <span class="n">iz</span> <span class="o">=</span> <span class="n">ix</span> <span class="o">+</span> <span class="n">iy</span><span class="o">*</span><span class="n">nX</span>
                        <span class="k">if</span> <span class="n">iz</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">nCz</span><span class="p">:</span>
                            <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">((</span><span class="n">ix</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vectorNx</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">x0</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">-</span><span class="n">pad</span><span class="p">,</span> <span class="p">(</span><span class="n">iy</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vectorNy</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">x0</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">+</span><span class="n">pad</span><span class="p">,</span>
                                     <span class="s1">&#39;#</span><span class="si">{0:.0f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">iz</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="n">annotationColor</span><span class="p">,</span> <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">,</span> <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="s1">&#39;x-large&#39;</span><span class="p">)</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">vType</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">showIt</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">ph</span></div>

<div class="viewcode-block" id="TensorView.plotSlice"><a class="viewcode-back" href="../../api/generated/discretize.View.TensorView.html#discretize.TensorView.plotSlice">[docs]</a>    <span class="k">def</span> <span class="nf">plotSlice</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">vType</span><span class="o">=</span><span class="s1">&#39;CC&#39;</span><span class="p">,</span>
        <span class="n">normal</span><span class="o">=</span><span class="s1">&#39;Z&#39;</span><span class="p">,</span> <span class="n">ind</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">view</span><span class="o">=</span><span class="s1">&#39;real&#39;</span><span class="p">,</span>
        <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">clim</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">showIt</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">pcolorOpts</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">streamOpts</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">gridOpts</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">range_x</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">range_y</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">sample_grid</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">stream_threshold</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">stream_thickness</span><span class="o">=</span><span class="kc">None</span>
    <span class="p">):</span>

        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Plots a slice of a 3D mesh.</span>

<span class="sd">        .. plot::</span>

<span class="sd">            import discretize</span>
<span class="sd">            from pymatsolver import Solver</span>
<span class="sd">            import numpy as np</span>
<span class="sd">            hx = [(5, 2, -1.3), (2, 4), (5, 2, 1.3)]</span>
<span class="sd">            hy = [(2, 2, -1.3), (2, 6), (2, 2, 1.3)]</span>
<span class="sd">            hz = [(2, 2, -1.3), (2, 6), (2, 2, 1.3)]</span>
<span class="sd">            M = discretize.TensorMesh([hx, hy, hz])</span>
<span class="sd">            q = np.zeros(M.vnC)</span>
<span class="sd">            q[[4, 4], [4, 4], [2, 6]]=[-1, 1]</span>
<span class="sd">            q = discretize.utils.mkvc(q)</span>
<span class="sd">            A = M.faceDiv * M.cellGrad</span>
<span class="sd">            b = Solver(A) * (q)</span>
<span class="sd">            M.plotSlice(M.cellGrad*b, &#39;F&#39;, view=&#39;vec&#39;, grid=True, showIt=True, pcolorOpts={&#39;alpha&#39;:0.8})</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">normal</span> <span class="o">=</span> <span class="n">normal</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">pcolorOpts</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">pcolorOpts</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">if</span> <span class="n">streamOpts</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">streamOpts</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span><span class="s1">&#39;k&#39;</span><span class="p">}</span>
        <span class="k">if</span> <span class="n">gridOpts</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">gridOpts</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="s1">&#39;alpha&#39;</span><span class="p">:</span><span class="mf">0.5</span><span class="p">}</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">vType</span><span class="p">)</span> <span class="ow">in</span> <span class="p">[</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">]:</span>
            <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">AssertionError</span><span class="p">(</span>
                    <span class="s2">&quot;cannot specify an axis to plot on with this function.&quot;</span>
                <span class="p">)</span>
            <span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">vType</span><span class="p">))</span>
            <span class="n">out</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">vTypeI</span><span class="p">,</span> <span class="n">ax</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">vType</span><span class="p">,</span> <span class="n">axs</span><span class="p">):</span>
                <span class="n">out</span> <span class="o">+=</span> <span class="p">[</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">plotSlice</span><span class="p">(</span>
                        <span class="n">v</span><span class="p">,</span> <span class="n">vType</span><span class="o">=</span><span class="n">vTypeI</span><span class="p">,</span> <span class="n">normal</span><span class="o">=</span><span class="n">normal</span><span class="p">,</span> <span class="n">ind</span><span class="o">=</span><span class="n">ind</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="n">grid</span><span class="p">,</span>
                        <span class="n">view</span><span class="o">=</span><span class="n">view</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">clim</span><span class="o">=</span><span class="n">clim</span><span class="p">,</span> <span class="n">showIt</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                        <span class="n">pcolorOpts</span><span class="o">=</span><span class="n">pcolorOpts</span><span class="p">,</span> <span class="n">streamOpts</span><span class="o">=</span><span class="n">streamOpts</span><span class="p">,</span>
                        <span class="n">gridOpts</span><span class="o">=</span><span class="n">gridOpts</span><span class="p">,</span> <span class="n">stream_threshold</span><span class="o">=</span><span class="n">stream_threshold</span><span class="p">,</span>
                        <span class="n">stream_thickness</span><span class="o">=</span><span class="n">stream_thickness</span>
                    <span class="p">)</span>
                <span class="p">]</span>
            <span class="k">return</span> <span class="n">out</span>
        <span class="n">viewOpts</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;real&#39;</span><span class="p">,</span> <span class="s1">&#39;imag&#39;</span><span class="p">,</span> <span class="s1">&#39;abs&#39;</span><span class="p">,</span> <span class="s1">&#39;vec&#39;</span><span class="p">]</span>
        <span class="n">normalOpts</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="s1">&#39;Z&#39;</span><span class="p">]</span>
        <span class="n">vTypeOpts</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;CC&#39;</span><span class="p">,</span> <span class="s1">&#39;CCv&#39;</span><span class="p">,</span> <span class="s1">&#39;N&#39;</span><span class="p">,</span> <span class="s1">&#39;F&#39;</span><span class="p">,</span> <span class="s1">&#39;E&#39;</span><span class="p">,</span> <span class="s1">&#39;Fx&#39;</span><span class="p">,</span> <span class="s1">&#39;Fy&#39;</span><span class="p">,</span> <span class="s1">&#39;Fz&#39;</span><span class="p">,</span> <span class="s1">&#39;E&#39;</span><span class="p">,</span> <span class="s1">&#39;Ex&#39;</span><span class="p">,</span> <span class="s1">&#39;Ey&#39;</span><span class="p">,</span> <span class="s1">&#39;Ez&#39;</span><span class="p">]</span>

        <span class="c1"># Some user error checking</span>
        <span class="k">if</span> <span class="n">vType</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">vTypeOpts</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">AssertionError</span><span class="p">(</span>
                <span class="s2">&quot;vType must be in [&#39;</span><span class="si">{0!s}</span><span class="s2">&#39;]&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;&#39;, &#39;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">vTypeOpts</span><span class="p">))</span>
            <span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">dim</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">AssertionError</span><span class="p">(</span>
                <span class="s1">&#39;Must be a 3D mesh. Use plotImage.&#39;</span>
            <span class="p">)</span>
        <span class="k">if</span> <span class="n">view</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">viewOpts</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">AssertionError</span><span class="p">(</span>
                <span class="s2">&quot;view must be in [&#39;</span><span class="si">{0!s}</span><span class="s2">&#39;]&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;&#39;, &#39;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">viewOpts</span><span class="p">))</span>
            <span class="p">)</span>
        <span class="k">if</span> <span class="n">normal</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">normalOpts</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">AssertionError</span><span class="p">(</span>
                <span class="s2">&quot;normal must be in [&#39;</span><span class="si">{0!s}</span><span class="s2">&#39;]&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;&#39;, &#39;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">normalOpts</span><span class="p">))</span>
            <span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">grid</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">AssertionError</span><span class="p">(</span><span class="s1">&#39;grid must be a boolean&#39;</span><span class="p">)</span>

        <span class="n">szSliceDim</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;nC&#39;</span><span class="o">+</span><span class="n">normal</span><span class="o">.</span><span class="n">lower</span><span class="p">())</span> <span class="c1">#: Size of the sliced dimension</span>
        <span class="k">if</span> <span class="n">ind</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="n">ind</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">szSliceDim</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">ind</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">integer_types</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">AssertionError</span><span class="p">(</span><span class="s1">&#39;ind must be an integer&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">dtype</span> <span class="o">==</span> <span class="nb">complex</span> <span class="ow">and</span> <span class="n">view</span> <span class="o">==</span> <span class="s1">&#39;vec&#39;</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">AssertionError</span><span class="p">(</span><span class="s1">&#39;Can not plot a complex vector.&#39;</span><span class="p">)</span>
        <span class="c1"># The slicing and plotting code!!</span>

        <span class="k">def</span> <span class="nf">getIndSlice</span><span class="p">(</span><span class="n">v</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">normal</span> <span class="o">==</span> <span class="s1">&#39;X&#39;</span><span class="p">:</span>
                <span class="n">v</span> <span class="o">=</span> <span class="n">v</span><span class="p">[</span><span class="n">ind</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:]</span>
            <span class="k">elif</span> <span class="n">normal</span> <span class="o">==</span> <span class="s1">&#39;Y&#39;</span><span class="p">:</span>
                <span class="n">v</span> <span class="o">=</span> <span class="n">v</span><span class="p">[:,</span> <span class="n">ind</span><span class="p">,</span> <span class="p">:]</span>
            <span class="k">elif</span> <span class="n">normal</span> <span class="o">==</span> <span class="s1">&#39;Z&#39;</span><span class="p">:</span>
                <span class="n">v</span> <span class="o">=</span> <span class="n">v</span><span class="p">[:,</span> <span class="p">:,</span> <span class="n">ind</span><span class="p">]</span>
            <span class="k">return</span> <span class="n">v</span>

        <span class="k">def</span> <span class="nf">doSlice</span><span class="p">(</span><span class="n">v</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">vType</span> <span class="o">==</span> <span class="s1">&#39;CC&#39;</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">getIndSlice</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="s1">&#39;CC&#39;</span><span class="p">,</span> <span class="s1">&#39;CC&#39;</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">))</span>
            <span class="k">elif</span> <span class="n">vType</span> <span class="o">==</span> <span class="s1">&#39;CCv&#39;</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">view</span> <span class="o">!=</span> <span class="s1">&#39;vec&#39;</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">AssertionError</span><span class="p">(</span><span class="s1">&#39;Other types for CCv not supported&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># Now just deal with &#39;F&#39; and &#39;E&#39; (x, y, z, maybe...)</span>
                <span class="n">aveOp</span> <span class="o">=</span> <span class="s1">&#39;ave&#39;</span> <span class="o">+</span> <span class="n">vType</span> <span class="o">+</span> <span class="p">(</span><span class="s1">&#39;2CCV&#39;</span> <span class="k">if</span> <span class="n">view</span> <span class="o">==</span> <span class="s1">&#39;vec&#39;</span> <span class="k">else</span> <span class="s1">&#39;2CC&#39;</span><span class="p">)</span>
                <span class="n">Av</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">aveOp</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">v</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="n">Av</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
                    <span class="n">v</span> <span class="o">=</span> <span class="n">Av</span> <span class="o">*</span> <span class="n">v</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">v</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">vType</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">vType</span><span class="p">)</span> <span class="c1"># get specific component</span>
                    <span class="n">v</span> <span class="o">=</span> <span class="n">Av</span> <span class="o">*</span> <span class="n">v</span>
                <span class="c1"># we should now be averaged to cell centers (might be a vector)</span>
            <span class="n">v</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">nC</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">order</span><span class="o">=</span><span class="s1">&#39;F&#39;</span><span class="p">),</span> <span class="s1">&#39;CC&#39;</span><span class="p">,</span> <span class="s1">&#39;CC&#39;</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">view</span> <span class="o">==</span> <span class="s1">&#39;vec&#39;</span><span class="p">:</span>
                <span class="n">outSlice</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">if</span> <span class="s1">&#39;X&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">normal</span><span class="p">:</span> <span class="n">outSlice</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">getIndSlice</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
                <span class="k">if</span> <span class="s1">&#39;Y&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">normal</span><span class="p">:</span> <span class="n">outSlice</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">getIndSlice</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
                <span class="k">if</span> <span class="s1">&#39;Z&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">normal</span><span class="p">:</span> <span class="n">outSlice</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">getIndSlice</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span>
                <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="n">mkvc</span><span class="p">(</span><span class="n">outSlice</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">mkvc</span><span class="p">(</span><span class="n">outSlice</span><span class="p">[</span><span class="mi">1</span><span class="p">])]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">getIndSlice</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="s1">&#39;CC&#39;</span><span class="p">,</span> <span class="s1">&#39;CC&#39;</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">))</span>

        <span class="n">h2d</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">x2d</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="s1">&#39;X&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">normal</span><span class="p">:</span>
            <span class="n">h2d</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">hx</span><span class="p">)</span>
            <span class="n">x2d</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x0</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">if</span> <span class="s1">&#39;Y&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">normal</span><span class="p">:</span>
            <span class="n">h2d</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">hy</span><span class="p">)</span>
            <span class="n">x2d</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x0</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">if</span> <span class="s1">&#39;Z&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">normal</span><span class="p">:</span>
            <span class="n">h2d</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">hz</span><span class="p">)</span>
            <span class="n">x2d</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x0</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
        <span class="n">tM</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="n">h</span><span class="o">=</span><span class="n">h2d</span><span class="p">,</span> <span class="n">x0</span><span class="o">=</span><span class="n">x2d</span><span class="p">)</span>  <span class="c1">#: Temp Mesh</span>
        <span class="n">v2d</span> <span class="o">=</span> <span class="n">doSlice</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
            <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">Axes</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">AssertionError</span><span class="p">(</span><span class="s2">&quot;ax must be an matplotlib.axes.Axes&quot;</span><span class="p">)</span>

        <span class="n">out</span> <span class="o">=</span> <span class="n">tM</span><span class="o">.</span><span class="n">_plotImage2D</span><span class="p">(</span>
            <span class="n">v2d</span><span class="p">,</span> <span class="n">vType</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;CCv&#39;</span> <span class="k">if</span> <span class="n">view</span> <span class="o">==</span> <span class="s1">&#39;vec&#39;</span> <span class="k">else</span> <span class="s1">&#39;CC&#39;</span><span class="p">),</span>
            <span class="n">grid</span><span class="o">=</span><span class="n">grid</span><span class="p">,</span> <span class="n">view</span><span class="o">=</span><span class="n">view</span><span class="p">,</span>
            <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">clim</span><span class="o">=</span><span class="n">clim</span><span class="p">,</span> <span class="n">showIt</span><span class="o">=</span><span class="n">showIt</span><span class="p">,</span>
            <span class="n">pcolorOpts</span><span class="o">=</span><span class="n">pcolorOpts</span><span class="p">,</span> <span class="n">streamOpts</span><span class="o">=</span><span class="n">streamOpts</span><span class="p">,</span>
            <span class="n">gridOpts</span><span class="o">=</span><span class="n">gridOpts</span><span class="p">,</span>
            <span class="n">range_x</span><span class="o">=</span><span class="n">range_x</span><span class="p">,</span>
            <span class="n">range_y</span><span class="o">=</span><span class="n">range_y</span><span class="p">,</span>
            <span class="n">sample_grid</span><span class="o">=</span><span class="n">sample_grid</span><span class="p">,</span>
            <span class="n">stream_threshold</span><span class="o">=</span><span class="n">stream_threshold</span><span class="p">,</span>
            <span class="n">stream_thickness</span><span class="o">=</span><span class="n">stream_thickness</span>

        <span class="p">)</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;y&#39;</span> <span class="k">if</span> <span class="n">normal</span> <span class="o">==</span> <span class="s1">&#39;X&#39;</span> <span class="k">else</span> <span class="s1">&#39;x&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;y&#39;</span> <span class="k">if</span> <span class="n">normal</span> <span class="o">==</span> <span class="s1">&#39;Z&#39;</span> <span class="k">else</span> <span class="s1">&#39;z&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Slice </span><span class="si">{0:.0f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ind</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">out</span></div>

    <span class="k">def</span> <span class="nf">_plotImage2D</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">vType</span><span class="o">=</span><span class="s1">&#39;CC&#39;</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">view</span><span class="o">=</span><span class="s1">&#39;real&#39;</span><span class="p">,</span>
        <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">clim</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">showIt</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">pcolorOpts</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">streamOpts</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">gridOpts</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">range_x</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">range_y</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">sample_grid</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">stream_threshold</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">stream_thickness</span><span class="o">=</span><span class="kc">None</span>
    <span class="p">):</span>

        <span class="k">if</span> <span class="n">pcolorOpts</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">pcolorOpts</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">if</span> <span class="n">streamOpts</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">streamOpts</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;k&#39;</span><span class="p">}</span>
        <span class="k">if</span> <span class="n">gridOpts</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">gridOpts</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;k&#39;</span><span class="p">}</span>
        <span class="n">vTypeOptsCC</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;N&#39;</span><span class="p">,</span> <span class="s1">&#39;CC&#39;</span><span class="p">,</span> <span class="s1">&#39;Fx&#39;</span><span class="p">,</span> <span class="s1">&#39;Fy&#39;</span><span class="p">,</span> <span class="s1">&#39;Ex&#39;</span><span class="p">,</span> <span class="s1">&#39;Ey&#39;</span><span class="p">]</span>
        <span class="n">vTypeOptsV</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;CCv&#39;</span><span class="p">,</span> <span class="s1">&#39;F&#39;</span><span class="p">,</span> <span class="s1">&#39;E&#39;</span><span class="p">]</span>
        <span class="n">vTypeOpts</span> <span class="o">=</span> <span class="n">vTypeOptsCC</span> <span class="o">+</span> <span class="n">vTypeOptsV</span>
        <span class="k">if</span> <span class="n">view</span> <span class="o">==</span> <span class="s1">&#39;vec&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">vType</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">vTypeOptsV</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">AssertionError</span><span class="p">(</span>
                    <span class="s2">&quot;vType must be in [&#39;</span><span class="si">{0!s}</span><span class="s2">&#39;] when view=&#39;vec&#39;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                        <span class="s2">&quot;&#39;, &#39;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">vTypeOptsV</span><span class="p">)</span>
                    <span class="p">)</span>
                <span class="p">)</span>
        <span class="k">if</span> <span class="n">vType</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">vTypeOpts</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">AssertionError</span><span class="p">(</span>
                <span class="s2">&quot;vType must be in [&#39;</span><span class="si">{0!s}</span><span class="s2">&#39;]&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;&#39;, &#39;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">vTypeOpts</span><span class="p">))</span>
            <span class="p">)</span>

        <span class="n">viewOpts</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;real&#39;</span><span class="p">,</span> <span class="s1">&#39;imag&#39;</span><span class="p">,</span> <span class="s1">&#39;abs&#39;</span><span class="p">,</span> <span class="s1">&#39;vec&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">view</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">viewOpts</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">AssertionError</span><span class="p">(</span>
                <span class="s2">&quot;view must be in [&#39;</span><span class="si">{0!s}</span><span class="s2">&#39;]&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;&#39;, &#39;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">viewOpts</span><span class="p">))</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
            <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">Axes</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">AssertionError</span><span class="p">(</span>
                    <span class="s2">&quot;ax must be an matplotlib.axes.Axes&quot;</span>
                <span class="p">)</span>

        <span class="c1"># Reshape to a cell centered variable</span>
        <span class="k">if</span> <span class="n">vType</span> <span class="o">==</span> <span class="s1">&#39;CC&#39;</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">elif</span> <span class="n">vType</span> <span class="o">==</span> <span class="s1">&#39;CCv&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">view</span> <span class="o">!=</span> <span class="s1">&#39;vec&#39;</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">AssertionError</span><span class="p">(</span><span class="s1">&#39;Other types for CCv not supported&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">vType</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;F&#39;</span><span class="p">,</span> <span class="s1">&#39;E&#39;</span><span class="p">,</span> <span class="s1">&#39;N&#39;</span><span class="p">]:</span>
            <span class="n">aveOp</span> <span class="o">=</span> <span class="s1">&#39;ave&#39;</span> <span class="o">+</span> <span class="n">vType</span> <span class="o">+</span> <span class="p">(</span><span class="s1">&#39;2CCV&#39;</span> <span class="k">if</span> <span class="n">view</span> <span class="o">==</span> <span class="s1">&#39;vec&#39;</span> <span class="k">else</span> <span class="s1">&#39;2CC&#39;</span><span class="p">)</span>
            <span class="n">v</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">aveOp</span><span class="p">)</span><span class="o">*</span><span class="n">v</span>  <span class="c1"># average to cell centers (might be a vector)</span>
        <span class="k">elif</span> <span class="n">vType</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;Fx&#39;</span><span class="p">,</span> <span class="s1">&#39;Fy&#39;</span><span class="p">,</span> <span class="s1">&#39;Ex&#39;</span><span class="p">,</span> <span class="s1">&#39;Ey&#39;</span><span class="p">]:</span>
            <span class="n">aveOp</span> <span class="o">=</span> <span class="s1">&#39;ave&#39;</span> <span class="o">+</span> <span class="n">vType</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;2CCV&#39;</span>
            <span class="n">v</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">aveOp</span><span class="p">)</span><span class="o">*</span><span class="n">v</span>  <span class="c1"># average to cell centers (might be a vector)</span>
            <span class="n">xORy</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">:</span><span class="mi">1</span> <span class="p">}[</span><span class="n">vType</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
            <span class="n">v</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">nC</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">order</span><span class="o">=</span><span class="s1">&#39;F&#39;</span><span class="p">)[:,</span> <span class="n">xORy</span><span class="p">]</span>

        <span class="n">out</span> <span class="o">=</span> <span class="p">()</span>
        <span class="k">if</span> <span class="n">view</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;real&#39;</span><span class="p">,</span> <span class="s1">&#39;imag&#39;</span><span class="p">,</span> <span class="s1">&#39;abs&#39;</span><span class="p">]:</span>
            <span class="n">v</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="s1">&#39;CC&#39;</span><span class="p">,</span> <span class="s1">&#39;CC&#39;</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">)</span>
            <span class="n">v</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">np</span><span class="p">,</span> <span class="n">view</span><span class="p">)(</span><span class="n">v</span><span class="p">)</span> <span class="c1"># e.g. np.real(v)</span>
            <span class="k">if</span> <span class="n">clim</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">clim</span> <span class="o">=</span> <span class="p">[</span><span class="n">v</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">v</span><span class="o">.</span><span class="n">max</span><span class="p">()]</span>
            <span class="n">v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">masked_where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">v</span><span class="p">),</span> <span class="n">v</span><span class="p">)</span>
            <span class="n">out</span> <span class="o">+=</span> <span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vectorNx</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">vectorNy</span><span class="p">,</span> <span class="n">v</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="n">clim</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">vmax</span><span class="o">=</span><span class="n">clim</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="o">**</span><span class="n">pcolorOpts</span><span class="p">),</span> <span class="p">)</span>
        <span class="k">elif</span> <span class="n">view</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;vec&#39;</span><span class="p">]:</span>
            <span class="c1"># Matplotlib seems to not support irregular</span>
            <span class="c1"># spaced vectors at the moment. So we will</span>
            <span class="c1"># Interpolate down to a regular mesh at the</span>
            <span class="c1"># smallest mesh size in this 2D slice.</span>
            <span class="k">if</span> <span class="n">sample_grid</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">hxmin</span> <span class="o">=</span> <span class="n">sample_grid</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">hymin</span> <span class="o">=</span> <span class="n">sample_grid</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">hxmin</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">hx</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
                <span class="n">hymin</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">hy</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>

            <span class="k">if</span> <span class="n">range_x</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">dx</span> <span class="o">=</span> <span class="p">(</span><span class="n">range_x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">range_x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                <span class="n">nxi</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">dx</span><span class="o">/</span><span class="n">hxmin</span><span class="p">)</span>
                <span class="n">hx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">nxi</span><span class="p">)</span><span class="o">*</span><span class="n">dx</span><span class="o">/</span><span class="n">nxi</span>
                <span class="n">x0_x</span> <span class="o">=</span> <span class="n">range_x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">nxi</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">hx</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">/</span><span class="n">hxmin</span><span class="p">)</span>
                <span class="n">hx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">nxi</span><span class="p">)</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">hx</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">/</span><span class="n">nxi</span>
                <span class="n">x0_x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">x0</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

            <span class="k">if</span> <span class="n">range_y</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">dy</span> <span class="o">=</span> <span class="p">(</span><span class="n">range_y</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">range_y</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                <span class="n">nyi</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">dy</span><span class="o">/</span><span class="n">hymin</span><span class="p">)</span>
                <span class="n">hy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">nyi</span><span class="p">)</span><span class="o">*</span><span class="n">dy</span><span class="o">/</span><span class="n">nyi</span>
                <span class="n">x0_y</span> <span class="o">=</span> <span class="n">range_y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">nyi</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">hy</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">/</span><span class="n">hymin</span><span class="p">)</span>
                <span class="n">hy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">nyi</span><span class="p">)</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">hy</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">/</span><span class="n">nyi</span>
                <span class="n">x0_y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">x0</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

            <span class="n">U</span><span class="p">,</span> <span class="n">V</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">nC</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">order</span><span class="o">=</span><span class="s1">&#39;F&#39;</span><span class="p">),</span> <span class="s1">&#39;CC&#39;</span><span class="p">,</span> <span class="s1">&#39;CC&#39;</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">clim</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">uv</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">U</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">V</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
                <span class="n">clim</span> <span class="o">=</span> <span class="p">[</span><span class="n">uv</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">uv</span><span class="o">.</span><span class="n">max</span><span class="p">()]</span>

            <span class="n">tMi</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="n">h</span><span class="o">=</span><span class="p">[</span><span class="n">hx</span><span class="p">,</span> <span class="n">hy</span><span class="p">],</span> <span class="n">x0</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="n">x0_x</span><span class="p">,</span> <span class="n">x0_y</span><span class="p">])</span>
            <span class="n">P</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getInterpolationMat</span><span class="p">(</span><span class="n">tMi</span><span class="o">.</span><span class="n">gridCC</span><span class="p">,</span> <span class="s1">&#39;CC&#39;</span><span class="p">,</span> <span class="n">zerosOutside</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

            <span class="n">Ui</span> <span class="o">=</span> <span class="n">tMi</span><span class="o">.</span><span class="n">r</span><span class="p">(</span><span class="n">P</span><span class="o">*</span><span class="n">mkvc</span><span class="p">(</span><span class="n">U</span><span class="p">),</span> <span class="s1">&#39;CC&#39;</span><span class="p">,</span> <span class="s1">&#39;CC&#39;</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">)</span>
            <span class="n">Vi</span> <span class="o">=</span> <span class="n">tMi</span><span class="o">.</span><span class="n">r</span><span class="p">(</span><span class="n">P</span><span class="o">*</span><span class="n">mkvc</span><span class="p">(</span><span class="n">V</span><span class="p">),</span> <span class="s1">&#39;CC&#39;</span><span class="p">,</span> <span class="s1">&#39;CC&#39;</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">)</span>
            <span class="c1"># End Interpolation</span>

            <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vectorNx</span>
            <span class="n">y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vectorNy</span>

            <span class="n">ind_CCx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vnC</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">bool</span><span class="p">)</span>
            <span class="n">ind_CCy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vnC</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">bool</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">range_x</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">x</span> <span class="o">=</span> <span class="n">tMi</span><span class="o">.</span><span class="n">vectorNx</span>

            <span class="k">if</span> <span class="n">range_y</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">y</span> <span class="o">=</span> <span class="n">tMi</span><span class="o">.</span><span class="n">vectorNy</span>

            <span class="k">if</span> <span class="n">range_x</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">range_y</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># use interpolated values</span>
                <span class="n">U</span> <span class="o">=</span> <span class="n">Ui</span>
                <span class="n">V</span> <span class="o">=</span> <span class="n">Vi</span>

            <span class="k">if</span> <span class="n">stream_threshold</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">mask_me</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">Ui</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">Vi</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">stream_threshold</span>
                <span class="n">Ui</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">masked_where</span><span class="p">(</span><span class="n">mask_me</span><span class="p">,</span> <span class="n">Ui</span><span class="p">)</span>
                <span class="n">Vi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">masked_where</span><span class="p">(</span><span class="n">mask_me</span><span class="p">,</span> <span class="n">Vi</span><span class="p">)</span>


            <span class="k">if</span> <span class="n">stream_thickness</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">scaleFact</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">stream_thickness</span><span class="p">)</span>

                <span class="c1"># Calculate vector amplitude</span>
                <span class="n">vecAmp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">U</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">V</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>

                <span class="c1"># Form bounds to knockout the top and bottom 10%</span>
                <span class="n">vecAmp_sort</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">vecAmp</span><span class="o">.</span><span class="n">ravel</span><span class="p">())</span>
                <span class="n">nVecAmp</span> <span class="o">=</span> <span class="n">vecAmp</span><span class="o">.</span><span class="n">size</span>
                <span class="n">tenPercInd</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="mf">0.1</span><span class="o">*</span><span class="n">nVecAmp</span><span class="p">))</span>
                <span class="n">lowerBound</span> <span class="o">=</span> <span class="n">vecAmp_sort</span><span class="p">[</span><span class="n">tenPercInd</span><span class="p">]</span>
                <span class="n">upperBound</span> <span class="o">=</span> <span class="n">vecAmp_sort</span><span class="p">[</span><span class="o">-</span><span class="n">tenPercInd</span><span class="p">]</span>

                <span class="n">lowInds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">vecAmp</span> <span class="o">&lt;</span> <span class="n">lowerBound</span><span class="p">)</span>
                <span class="n">vecAmp</span><span class="p">[</span><span class="n">lowInds</span><span class="p">]</span> <span class="o">=</span> <span class="n">lowerBound</span>

                <span class="n">highInds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">vecAmp</span> <span class="o">&gt;</span> <span class="n">upperBound</span><span class="p">)</span>
                <span class="n">vecAmp</span><span class="p">[</span><span class="n">highInds</span><span class="p">]</span> <span class="o">=</span> <span class="n">upperBound</span>

                <span class="c1"># Normalize amplitudes 0-1</span>
                <span class="n">norm_thickness</span> <span class="o">=</span> <span class="n">vecAmp</span><span class="o">/</span><span class="n">vecAmp</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>

                <span class="c1"># Scale by user defined thickness factor</span>
                <span class="n">stream_thickness</span> <span class="o">=</span> <span class="n">scaleFact</span><span class="o">*</span><span class="n">norm_thickness</span>

                <span class="c1"># Add linewidth to streamOpts</span>
                <span class="n">streamOpts</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;linewidth&#39;</span><span class="p">:</span><span class="n">stream_thickness</span><span class="p">})</span>


            <span class="n">out</span> <span class="o">+=</span> <span class="p">(</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span>
                    <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">U</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">V</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="n">clim</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">vmax</span><span class="o">=</span><span class="n">clim</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                    <span class="o">**</span><span class="n">pcolorOpts</span><span class="p">),</span>
            <span class="p">)</span>
            <span class="n">out</span> <span class="o">+=</span> <span class="p">(</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">streamplot</span><span class="p">(</span>
                    <span class="n">tMi</span><span class="o">.</span><span class="n">vectorCCx</span><span class="p">,</span> <span class="n">tMi</span><span class="o">.</span><span class="n">vectorCCy</span><span class="p">,</span> <span class="n">Ui</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">Vi</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="o">**</span><span class="n">streamOpts</span>
                <span class="p">),</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="n">grid</span><span class="p">:</span>
            <span class="n">xXGrid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">c_</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">vectorNx</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">vectorNx</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nNx</span><span class="p">)]</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
            <span class="n">xYGrid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">c_</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">vectorNy</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nNx</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">vectorNy</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nNx</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nNx</span><span class="p">)]</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
            <span class="n">yXGrid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">c_</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">vectorNx</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nNy</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">vectorNx</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nNy</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nNy</span><span class="p">)]</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
            <span class="n">yYGrid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">c_</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">vectorNy</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">vectorNy</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nNy</span><span class="p">)]</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
            <span class="n">out</span> <span class="o">+=</span> <span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="n">xXGrid</span><span class="p">,</span> <span class="n">yXGrid</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="n">xYGrid</span><span class="p">,</span> <span class="n">yYGrid</span><span class="p">],</span> <span class="o">**</span><span class="n">gridOpts</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span> <span class="p">)</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">range_x</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">*</span><span class="n">range_x</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">vectorNx</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]])</span>

        <span class="k">if</span> <span class="n">range_y</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">*</span><span class="n">range_y</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">vectorNy</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]])</span>

        <span class="k">if</span> <span class="n">showIt</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">out</span>

<div class="viewcode-block" id="TensorView.plotGrid"><a class="viewcode-back" href="../../api/generated/discretize.View.TensorView.html#discretize.TensorView.plotGrid">[docs]</a>    <span class="k">def</span> <span class="nf">plotGrid</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">nodes</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">faces</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">centers</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">edges</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">lines</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">showIt</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Plot the nodal, cell-centered and staggered grids for 1,2 and 3 dimensions.</span>

<span class="sd">        :param bool nodes: plot nodes</span>
<span class="sd">        :param bool faces: plot faces</span>
<span class="sd">        :param bool centers: plot centers</span>
<span class="sd">        :param bool edges: plot edges</span>
<span class="sd">        :param bool lines: plot lines connecting nodes</span>
<span class="sd">        :param bool showIt: call plt.show()</span>

<span class="sd">        .. plot::</span>
<span class="sd">           :include-source:</span>

<span class="sd">           import discretize</span>
<span class="sd">           import numpy as np</span>
<span class="sd">           h1 = np.linspace(.1, .5, 3)</span>
<span class="sd">           h2 = np.linspace(.1, .5, 5)</span>
<span class="sd">           mesh = discretize.TensorMesh([h1, h2])</span>
<span class="sd">           mesh.plotGrid(nodes=True, faces=True, centers=True, lines=True, showIt=True)</span>

<span class="sd">        .. plot::</span>
<span class="sd">           :include-source:</span>

<span class="sd">           import discretize</span>
<span class="sd">           import numpy as np</span>
<span class="sd">           h1 = np.linspace(.1, .5, 3)</span>
<span class="sd">           h2 = np.linspace(.1, .5, 5)</span>
<span class="sd">           h3 = np.linspace(.1, .5, 3)</span>
<span class="sd">           mesh = discretize.TensorMesh([h1, h2, h3])</span>
<span class="sd">           mesh.plotGrid(nodes=True, faces=True, centers=True, lines=True, showIt=True)</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">axOpts</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;projection&#39;</span><span class="p">:</span> <span class="s1">&#39;3d&#39;</span><span class="p">}</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dim</span> <span class="o">==</span> <span class="mi">3</span> <span class="k">else</span> <span class="p">{}</span>
        <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
            <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">,</span> <span class="o">**</span><span class="n">axOpts</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">Axes</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">AssertionError</span><span class="p">(</span><span class="s2">&quot;ax must be an matplotlib.axes.Axes&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dim</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">nodes</span><span class="p">:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">gridN</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nN</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;C0&quot;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;s&quot;</span><span class="p">,</span>
                    <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;&quot;</span>
                <span class="p">)</span>
            <span class="k">if</span> <span class="n">centers</span><span class="p">:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">gridCC</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nC</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;C1&quot;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">,</span>
                    <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;&quot;</span>
                <span class="p">)</span>
            <span class="k">if</span> <span class="n">lines</span><span class="p">:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">gridN</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nN</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;C0&quot;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;-&quot;</span>
                <span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x1&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">dim</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">nodes</span><span class="p">:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">gridN</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">gridN</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;C0&quot;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;s&quot;</span><span class="p">,</span>
                    <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;&quot;</span>
                <span class="p">)</span>
            <span class="k">if</span> <span class="n">centers</span><span class="p">:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">gridCC</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">gridCC</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;C1&quot;</span><span class="p">,</span>
                    <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;&quot;</span>
                <span class="p">)</span>
            <span class="k">if</span> <span class="n">faces</span><span class="p">:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">gridFx</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">gridFx</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;C2&quot;</span><span class="p">,</span>
                    <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;&gt;&quot;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;&quot;</span>
                <span class="p">)</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">gridFy</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">gridFy</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;C2&quot;</span><span class="p">,</span>
                    <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;^&quot;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;&quot;</span>
                <span class="p">)</span>
            <span class="k">if</span> <span class="n">edges</span><span class="p">:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">gridEx</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">gridEx</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;C3&quot;</span><span class="p">,</span>
                    <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;&gt;&quot;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;&quot;</span>
                <span class="p">)</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">gridEy</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">gridEy</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;C3&quot;</span><span class="p">,</span>
                    <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;^&quot;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;&quot;</span>
                <span class="p">)</span>

            <span class="n">color</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;color&#39;</span><span class="p">,</span> <span class="s1">&#39;C0&#39;</span><span class="p">)</span>
            <span class="n">linewidth</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;linewidth&#39;</span><span class="p">,</span> <span class="mf">1.</span><span class="p">)</span>
            <span class="c1"># Plot the grid lines</span>
            <span class="k">if</span> <span class="n">lines</span><span class="p">:</span>
                <span class="n">NN</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gridN</span><span class="p">,</span> <span class="s1">&#39;N&#39;</span><span class="p">,</span> <span class="s1">&#39;N&#39;</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">)</span>
                <span class="n">X1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">c_</span><span class="p">[</span><span class="n">mkvc</span><span class="p">(</span><span class="n">NN</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]),</span> <span class="n">mkvc</span><span class="p">(</span><span class="n">NN</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="bp">self</span><span class="o">.</span><span class="n">nCx</span><span class="p">,</span> <span class="p">:]),</span> <span class="n">mkvc</span><span class="p">(</span><span class="n">NN</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">,</span> <span class="p">:])</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">]</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
                <span class="n">Y1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">c_</span><span class="p">[</span><span class="n">mkvc</span><span class="p">(</span><span class="n">NN</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]),</span> <span class="n">mkvc</span><span class="p">(</span><span class="n">NN</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="bp">self</span><span class="o">.</span><span class="n">nCx</span><span class="p">,</span> <span class="p">:]),</span> <span class="n">mkvc</span><span class="p">(</span><span class="n">NN</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">,</span> <span class="p">:])</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">]</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
                <span class="n">X2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">c_</span><span class="p">[</span><span class="n">mkvc</span><span class="p">(</span><span class="n">NN</span><span class="p">[</span><span class="mi">0</span><span class="p">][:,</span> <span class="mi">0</span><span class="p">]),</span> <span class="n">mkvc</span><span class="p">(</span><span class="n">NN</span><span class="p">[</span><span class="mi">0</span><span class="p">][:,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nCy</span><span class="p">]),</span> <span class="n">mkvc</span><span class="p">(</span><span class="n">NN</span><span class="p">[</span><span class="mi">0</span><span class="p">][:,</span> <span class="mi">0</span><span class="p">])</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">]</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
                <span class="n">Y2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">c_</span><span class="p">[</span><span class="n">mkvc</span><span class="p">(</span><span class="n">NN</span><span class="p">[</span><span class="mi">1</span><span class="p">][:,</span> <span class="mi">0</span><span class="p">]),</span> <span class="n">mkvc</span><span class="p">(</span><span class="n">NN</span><span class="p">[</span><span class="mi">1</span><span class="p">][:,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nCy</span><span class="p">]),</span> <span class="n">mkvc</span><span class="p">(</span><span class="n">NN</span><span class="p">[</span><span class="mi">1</span><span class="p">][:,</span> <span class="mi">0</span><span class="p">])</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">]</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
                <span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="n">X1</span><span class="p">,</span> <span class="n">X2</span><span class="p">]</span>
                <span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="n">Y1</span><span class="p">,</span> <span class="n">Y2</span><span class="p">]</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="n">linewidth</span><span class="p">)</span>

            <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x1&#39;</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;x2&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">dim</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">nodes</span><span class="p">:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">gridN</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">gridN</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;C0&quot;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;s&quot;</span><span class="p">,</span>
                    <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">zs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">gridN</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">]</span>
                <span class="p">)</span>
            <span class="k">if</span> <span class="n">centers</span><span class="p">:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">gridCC</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">gridCC</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;C1&quot;</span><span class="p">,</span>
                    <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">zs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">gridCC</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">]</span>
                <span class="p">)</span>
            <span class="k">if</span> <span class="n">faces</span><span class="p">:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">gridFx</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">gridFx</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;C2&quot;</span><span class="p">,</span>
                    <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;&gt;&quot;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">zs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">gridFx</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">]</span>
                <span class="p">)</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">gridFy</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">gridFy</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;C2&quot;</span><span class="p">,</span>
                    <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;&lt;&quot;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">zs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">gridFy</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">]</span>
                <span class="p">)</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">gridFz</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">gridFz</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;C2&quot;</span><span class="p">,</span>
                    <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;^&quot;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">zs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">gridFz</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">]</span>
                <span class="p">)</span>
            <span class="k">if</span> <span class="n">edges</span><span class="p">:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">gridEx</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">gridEx</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;C3&quot;</span><span class="p">,</span>
                    <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;&gt;&quot;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">zs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">gridEx</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">]</span>
                <span class="p">)</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">gridEy</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">gridEy</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;C3&quot;</span><span class="p">,</span>
                    <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;&lt;&quot;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">zs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">gridEy</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">]</span>
                <span class="p">)</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">gridEz</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">gridEz</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;C3&quot;</span><span class="p">,</span>
                    <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;^&quot;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">zs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">gridEz</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">]</span>
                <span class="p">)</span>

            <span class="c1"># Plot the grid lines</span>
            <span class="k">if</span> <span class="n">lines</span><span class="p">:</span>
                <span class="n">NN</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gridN</span><span class="p">,</span> <span class="s1">&#39;N&#39;</span><span class="p">,</span> <span class="s1">&#39;N&#39;</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">)</span>
                <span class="n">X1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">c_</span><span class="p">[</span><span class="n">mkvc</span><span class="p">(</span><span class="n">NN</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:]),</span> <span class="n">mkvc</span><span class="p">(</span><span class="n">NN</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="bp">self</span><span class="o">.</span><span class="n">nCx</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:]),</span> <span class="n">mkvc</span><span class="p">(</span><span class="n">NN</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:])</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">]</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
                <span class="n">Y1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">c_</span><span class="p">[</span><span class="n">mkvc</span><span class="p">(</span><span class="n">NN</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:]),</span> <span class="n">mkvc</span><span class="p">(</span><span class="n">NN</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="bp">self</span><span class="o">.</span><span class="n">nCx</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:]),</span> <span class="n">mkvc</span><span class="p">(</span><span class="n">NN</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:])</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">]</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
                <span class="n">Z1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">c_</span><span class="p">[</span><span class="n">mkvc</span><span class="p">(</span><span class="n">NN</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:]),</span> <span class="n">mkvc</span><span class="p">(</span><span class="n">NN</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="bp">self</span><span class="o">.</span><span class="n">nCx</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:]),</span> <span class="n">mkvc</span><span class="p">(</span><span class="n">NN</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:])</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">]</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
                <span class="n">X2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">c_</span><span class="p">[</span><span class="n">mkvc</span><span class="p">(</span><span class="n">NN</span><span class="p">[</span><span class="mi">0</span><span class="p">][:,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">:]),</span> <span class="n">mkvc</span><span class="p">(</span><span class="n">NN</span><span class="p">[</span><span class="mi">0</span><span class="p">][:,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nCy</span><span class="p">,</span> <span class="p">:]),</span> <span class="n">mkvc</span><span class="p">(</span><span class="n">NN</span><span class="p">[</span><span class="mi">0</span><span class="p">][:,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">:])</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">]</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
                <span class="n">Y2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">c_</span><span class="p">[</span><span class="n">mkvc</span><span class="p">(</span><span class="n">NN</span><span class="p">[</span><span class="mi">1</span><span class="p">][:,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">:]),</span> <span class="n">mkvc</span><span class="p">(</span><span class="n">NN</span><span class="p">[</span><span class="mi">1</span><span class="p">][:,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nCy</span><span class="p">,</span> <span class="p">:]),</span> <span class="n">mkvc</span><span class="p">(</span><span class="n">NN</span><span class="p">[</span><span class="mi">1</span><span class="p">][:,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">:])</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">]</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
                <span class="n">Z2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">c_</span><span class="p">[</span><span class="n">mkvc</span><span class="p">(</span><span class="n">NN</span><span class="p">[</span><span class="mi">2</span><span class="p">][:,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">:]),</span> <span class="n">mkvc</span><span class="p">(</span><span class="n">NN</span><span class="p">[</span><span class="mi">2</span><span class="p">][:,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nCy</span><span class="p">,</span> <span class="p">:]),</span> <span class="n">mkvc</span><span class="p">(</span><span class="n">NN</span><span class="p">[</span><span class="mi">2</span><span class="p">][:,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">:])</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">]</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
                <span class="n">X3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">c_</span><span class="p">[</span><span class="n">mkvc</span><span class="p">(</span><span class="n">NN</span><span class="p">[</span><span class="mi">0</span><span class="p">][:,</span> <span class="p">:,</span> <span class="mi">0</span><span class="p">]),</span> <span class="n">mkvc</span><span class="p">(</span><span class="n">NN</span><span class="p">[</span><span class="mi">0</span><span class="p">][:,</span> <span class="p">:,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nCz</span><span class="p">]),</span> <span class="n">mkvc</span><span class="p">(</span><span class="n">NN</span><span class="p">[</span><span class="mi">0</span><span class="p">][:,</span> <span class="p">:,</span> <span class="mi">0</span><span class="p">])</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">]</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
                <span class="n">Y3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">c_</span><span class="p">[</span><span class="n">mkvc</span><span class="p">(</span><span class="n">NN</span><span class="p">[</span><span class="mi">1</span><span class="p">][:,</span> <span class="p">:,</span> <span class="mi">0</span><span class="p">]),</span> <span class="n">mkvc</span><span class="p">(</span><span class="n">NN</span><span class="p">[</span><span class="mi">1</span><span class="p">][:,</span> <span class="p">:,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nCz</span><span class="p">]),</span> <span class="n">mkvc</span><span class="p">(</span><span class="n">NN</span><span class="p">[</span><span class="mi">1</span><span class="p">][:,</span> <span class="p">:,</span> <span class="mi">0</span><span class="p">])</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">]</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
                <span class="n">Z3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">c_</span><span class="p">[</span><span class="n">mkvc</span><span class="p">(</span><span class="n">NN</span><span class="p">[</span><span class="mi">2</span><span class="p">][:,</span> <span class="p">:,</span> <span class="mi">0</span><span class="p">]),</span> <span class="n">mkvc</span><span class="p">(</span><span class="n">NN</span><span class="p">[</span><span class="mi">2</span><span class="p">][:,</span> <span class="p">:,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nCz</span><span class="p">]),</span> <span class="n">mkvc</span><span class="p">(</span><span class="n">NN</span><span class="p">[</span><span class="mi">2</span><span class="p">][:,</span> <span class="p">:,</span> <span class="mi">0</span><span class="p">])</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">]</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
                <span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="n">X1</span><span class="p">,</span> <span class="n">X2</span><span class="p">,</span> <span class="n">X3</span><span class="p">]</span>
                <span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="n">Y1</span><span class="p">,</span> <span class="n">Y2</span><span class="p">,</span> <span class="n">Y3</span><span class="p">]</span>
                <span class="n">Z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="n">Z1</span><span class="p">,</span> <span class="n">Z2</span><span class="p">,</span> <span class="n">Z3</span><span class="p">]</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;C0&quot;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="n">zs</span><span class="o">=</span><span class="n">Z</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x1&#39;</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;x2&#39;</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_zlabel</span><span class="p">(</span><span class="s1">&#39;x3&#39;</span><span class="p">)</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">showIt</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">ax</span></div>


<div class="viewcode-block" id="TensorView.plot_3d_slicer"><a class="viewcode-back" href="../../api/generated/discretize.View.TensorView.html#discretize.TensorView.plot_3d_slicer">[docs]</a>    <span class="k">def</span> <span class="nf">plot_3d_slicer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">xslice</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">yslice</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">zslice</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                       <span class="n">vType</span><span class="o">=</span><span class="s1">&#39;CC&#39;</span><span class="p">,</span> <span class="n">view</span><span class="o">=</span><span class="s1">&#39;real&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;xy&#39;</span><span class="p">,</span> <span class="n">transparent</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                       <span class="n">clim</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">xlim</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ylim</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">zlim</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                       <span class="n">aspect</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">pcolorOpts</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                       <span class="n">fig</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Plot slices of a 3D volume, interactively (scroll wheel).</span>

<span class="sd">        If called from a notebook, make sure to set</span>

<span class="sd">            %matplotlib notebook</span>

<span class="sd">        See the class `discretize.View.Slicer` for more information.</span>

<span class="sd">        It returns nothing. However, if you need the different figure handles</span>
<span class="sd">        you can get it via</span>

<span class="sd">          `fig = plt.gcf()`</span>

<span class="sd">        and subsequently its children via</span>

<span class="sd">          `fig.get_children()`</span>

<span class="sd">        and recursively deeper, e.g.,</span>

<span class="sd">          `fig.get_children()[0].get_children()`.</span>

<span class="sd">        One can also provide an existing figure instance, which can be useful</span>
<span class="sd">        for interactive widgets in Notebooks. The provided figure is cleared</span>
<span class="sd">        first.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Initiate figure</span>
        <span class="k">if</span> <span class="n">fig</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">fig</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>

        <span class="c1"># Populate figure</span>
        <span class="n">tracker</span> <span class="o">=</span> <span class="n">Slicer</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">xslice</span><span class="p">,</span> <span class="n">yslice</span><span class="p">,</span> <span class="n">zslice</span><span class="p">,</span> <span class="n">vType</span><span class="p">,</span> <span class="n">view</span><span class="p">,</span> <span class="n">axis</span><span class="p">,</span> <span class="n">transparent</span><span class="p">,</span>
            <span class="n">clim</span><span class="p">,</span> <span class="n">xlim</span><span class="p">,</span> <span class="n">ylim</span><span class="p">,</span> <span class="n">zlim</span><span class="p">,</span> <span class="n">aspect</span><span class="p">,</span> <span class="n">grid</span><span class="p">,</span> <span class="n">pcolorOpts</span>
        <span class="p">)</span>

        <span class="c1"># Connect figure to scrolling</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">mpl_connect</span><span class="p">(</span><span class="s1">&#39;scroll_event&#39;</span><span class="p">,</span> <span class="n">tracker</span><span class="o">.</span><span class="n">onscroll</span><span class="p">)</span>

        <span class="c1"># Show figure</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></div></div>


<div class="viewcode-block" id="CylView"><a class="viewcode-back" href="../../api/generated/discretize.View.CylView.html#discretize.CylView">[docs]</a><span class="nd">@requires</span><span class="p">({</span><span class="s1">&#39;matplotlib&#39;</span><span class="p">:</span> <span class="n">matplotlib</span><span class="p">})</span>
<span class="k">class</span> <span class="nc">CylView</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">_plotCylTensorMesh</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">plotType</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">isSymmetric</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;We have not yet implemented this type of view.&#39;</span><span class="p">)</span>
        <span class="k">assert</span> <span class="n">plotType</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;plotImage&#39;</span><span class="p">,</span> <span class="s1">&#39;plotGrid&#39;</span><span class="p">]</span>
        <span class="c1"># Hackity Hack:</span>
        <span class="c1"># Just create a TM and use its view.</span>
        <span class="kn">from</span> <span class="nn">discretize</span> <span class="k">import</span> <span class="n">TensorMesh</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">val</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="n">vType</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;vType&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">mirror</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;mirror&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">mirror_data</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;mirror_data&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">mirror_data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">mirror</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">mirror</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">if</span> <span class="n">vType</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">vType</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">!=</span> <span class="s1">&#39;CCV&#39;</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">vType</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;F&#39;</span><span class="p">:</span>
                    <span class="n">val</span> <span class="o">=</span> <span class="n">mkvc</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">aveF2CCV</span> <span class="o">*</span> <span class="n">val</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">mirror_data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="n">mirror_data</span> <span class="o">=</span> <span class="n">mkvc</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">aveF2CCV</span> <span class="o">*</span> <span class="n">mirror_data</span><span class="p">)</span>
                    <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;vType&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;CCv&#39;</span>  <span class="c1"># now the vector is cell centered</span>
                <span class="k">if</span> <span class="n">vType</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;E&#39;</span><span class="p">:</span>
                    <span class="n">val</span> <span class="o">=</span> <span class="n">mkvc</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">aveE2CCV</span> <span class="o">*</span> <span class="n">val</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">mirror_data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="n">mirror_data</span> <span class="o">=</span> <span class="n">mkvc</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">aveE2CCV</span> <span class="o">*</span> <span class="n">mirror_data</span><span class="p">)</span>
                <span class="n">args</span> <span class="o">=</span> <span class="p">(</span><span class="n">val</span><span class="p">,)</span> <span class="o">+</span> <span class="n">args</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>

        <span class="k">if</span> <span class="n">mirror</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
            <span class="c1"># create a mirrored mesh</span>
            <span class="n">hx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">flipud</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">hx</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">hx</span><span class="p">])</span>
            <span class="n">x00</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">x0</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">hx</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
            <span class="n">M</span> <span class="o">=</span> <span class="n">TensorMesh</span><span class="p">([</span><span class="n">hx</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">hz</span><span class="p">],</span> <span class="n">x0</span><span class="o">=</span><span class="p">[</span><span class="n">x00</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">x0</span><span class="p">[</span><span class="mi">2</span><span class="p">]])</span>

            <span class="k">if</span> <span class="n">mirror_data</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">mirror_data</span> <span class="o">=</span> <span class="n">val</span>

            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">val</span><span class="p">)</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">nC</span><span class="p">:</span>  <span class="c1"># only a single value at cell centers</span>
                <span class="n">val</span> <span class="o">=</span> <span class="n">val</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vnC</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">vnC</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">order</span><span class="o">=</span><span class="s1">&#39;F&#39;</span><span class="p">)</span>
                <span class="n">mirror_val</span> <span class="o">=</span> <span class="n">mirror_data</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">vnC</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">vnC</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">order</span><span class="o">=</span><span class="s1">&#39;F&#39;</span>
                <span class="p">)</span>
                <span class="n">val</span> <span class="o">=</span> <span class="n">mkvc</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">flipud</span><span class="p">(</span><span class="n">mirror_val</span><span class="p">),</span> <span class="n">val</span><span class="p">]))</span>

            <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">val</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">nC</span><span class="p">:</span>
                <span class="n">val_x</span> <span class="o">=</span> <span class="n">val</span><span class="p">[:</span><span class="bp">self</span><span class="o">.</span><span class="n">nC</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">vnC</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">vnC</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">order</span><span class="o">=</span><span class="s1">&#39;F&#39;</span>
                <span class="p">)</span>
                <span class="n">val_z</span> <span class="o">=</span> <span class="n">val</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">nC</span><span class="p">:]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">vnC</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">vnC</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">order</span><span class="o">=</span><span class="s1">&#39;F&#39;</span>
                <span class="p">)</span>

                <span class="n">mirror_x</span> <span class="o">=</span> <span class="n">mirror_data</span><span class="p">[:</span><span class="bp">self</span><span class="o">.</span><span class="n">nC</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">vnC</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">vnC</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">order</span><span class="o">=</span><span class="s1">&#39;F&#39;</span>
                <span class="p">)</span>
                <span class="n">mirror_z</span> <span class="o">=</span> <span class="n">mirror_data</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">nC</span><span class="p">:]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">vnC</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">vnC</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">order</span><span class="o">=</span><span class="s1">&#39;F&#39;</span>
                <span class="p">)</span>

                <span class="n">val_x</span> <span class="o">=</span> <span class="n">mkvc</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="o">-</span><span class="mf">1.</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">flipud</span><span class="p">(</span><span class="n">mirror_x</span><span class="p">),</span> <span class="n">val_x</span><span class="p">]))</span> <span class="c1"># by symmetry</span>
                <span class="n">val_z</span> <span class="o">=</span> <span class="n">mkvc</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">flipud</span><span class="p">(</span><span class="n">mirror_z</span><span class="p">),</span> <span class="n">val_z</span><span class="p">]))</span>

                <span class="n">val</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">([</span><span class="n">val_x</span><span class="p">,</span> <span class="n">val_z</span><span class="p">])</span>

            <span class="n">args</span> <span class="o">=</span> <span class="p">(</span><span class="n">val</span><span class="p">,)</span> <span class="o">+</span> <span class="n">args</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">M</span> <span class="o">=</span> <span class="n">TensorMesh</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">hx</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">hz</span><span class="p">],</span> <span class="n">x0</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">x0</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">x0</span><span class="p">[</span><span class="mi">2</span><span class="p">]])</span>

        <span class="n">ax</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ax&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
            <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;ax&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ax</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">Axes</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">AssertionError</span><span class="p">(</span><span class="s2">&quot;ax must be an matplotlib.axes.Axes&quot;</span><span class="p">)</span>
            <span class="n">fig</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">figure</span>

        <span class="c1"># Don&#39;t show things in the TM.plotImage</span>
        <span class="n">showIt</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;showIt&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;showIt&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="n">out</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">plotType</span><span class="p">)(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;z&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">showIt</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">out</span>

<div class="viewcode-block" id="CylView.plotGrid"><a class="viewcode-back" href="../../api/generated/discretize.View.CylView.html#discretize.CylView.plotGrid">[docs]</a>    <span class="k">def</span> <span class="nf">plotGrid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">isSymmetric</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_plotCylTensorMesh</span><span class="p">(</span><span class="s1">&#39;plotGrid&#39;</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="c1"># allow a slice to be provided for the mesh</span>
        <span class="n">slc</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;slice&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">slc</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">slc</span> <span class="o">=</span> <span class="n">slc</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">slc</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;theta&#39;</span><span class="p">,</span> <span class="s1">&#39;z&#39;</span><span class="p">,</span> <span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="ne">AssertionError</span><span class="p">(</span>
                <span class="s2">&quot;slice must be either &#39;theta&#39;,&#39;z&#39;, or &#39;both&#39; not </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="n">slc</span>
                <span class="p">)</span>
            <span class="p">)</span>

        <span class="c1"># if slc is None, provide slices in both the theta and z directions</span>
        <span class="k">if</span> <span class="n">slc</span> <span class="o">==</span> <span class="s1">&#39;theta&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_plotGridThetaSlice</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">slc</span> <span class="o">==</span> <span class="s1">&#39;z&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_plotGridZSlice</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ax</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;ax&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>
                    <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
                        <span class="s2">&quot;two axes handles must be provided to plot both theta &quot;</span>
                        <span class="s2">&quot;and z slices through the mesh. Over-writing the axes.&quot;</span>
                    <span class="p">)</span>
                    <span class="n">ax</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="c1"># find the one with a polar projection and pass it to the</span>
                    <span class="c1"># theta slice, other one to the z-slice</span>
                    <span class="n">polarax</span> <span class="o">=</span> <span class="p">[</span><span class="n">a</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">ax</span> <span class="k">if</span> <span class="n">a</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;PolarAxesSubplot&#39;</span><span class="p">]</span>
                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">polarax</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
                        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">No polar axes provided. Over-writing the axes. If you prefer to create your</span>
<span class="s2">own, please use</span>

<span class="s2">    `ax = plt.subplot(121, projection=&#39;polar&#39;)`</span>

<span class="s2">for reference, see: http://matplotlib.org/examples/pylab_examples/polar_demo.html</span>
<span class="s2">                    https://github.com/matplotlib/matplotlib/issues/312</span>
<span class="s2">                    &quot;&quot;&quot;</span><span class="p">)</span>
                        <span class="n">ax</span> <span class="o">=</span> <span class="kc">None</span>

                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">polarax</span> <span class="o">=</span> <span class="n">polarax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                        <span class="n">cartax</span> <span class="o">=</span> <span class="p">[</span><span class="n">a</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">ax</span> <span class="k">if</span> <span class="n">a</span> <span class="o">!=</span> <span class="n">polarax</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>

            <span class="c1"># ax may have been None to start with or set to None</span>
            <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
                <span class="n">polarax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">121</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s1">&#39;polar&#39;</span><span class="p">)</span>
                <span class="n">cartax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">122</span><span class="p">)</span>

            <span class="c1"># update kwargs with respective axes handles</span>
            <span class="n">kwargspolar</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
            <span class="n">kwargspolar</span><span class="p">[</span><span class="s1">&#39;ax&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">polarax</span>

            <span class="n">kwargscart</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
            <span class="n">kwargscart</span><span class="p">[</span><span class="s1">&#39;ax&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">cartax</span>

            <span class="n">ax</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_plotGridZSlice</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargspolar</span><span class="p">))</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_plotGridThetaSlice</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargscart</span><span class="p">))</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">ax</span></div>

    <span class="k">def</span> <span class="nf">_plotGridThetaSlice</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">isSymmetric</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">plotGrid</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="c1"># make a cyl symmetric mesh</span>
        <span class="n">h2d</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">hx</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">hz</span><span class="p">]</span>
        <span class="n">mesh2D</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="n">h</span><span class="o">=</span><span class="n">h2d</span><span class="p">,</span> <span class="n">x0</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">x0</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">mesh2D</span><span class="o">.</span><span class="n">plotGrid</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_plotGridZSlice</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="c1"># https://github.com/matplotlib/matplotlib/issues/312</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ax&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">ax</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">!=</span> <span class="s2">&quot;PolarAxesSubplot&quot;</span><span class="p">:</span>
                <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
                    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Creating new axes with Polar projection. If you prefer to create your own, please use</span>

<span class="sd">    `ax = plt.subplot(121, projection=&#39;polar&#39;)`</span>

<span class="sd">for reference, see: http://matplotlib.org/examples/pylab_examples/polar_demo.html</span>
<span class="sd">                    https://github.com/matplotlib/matplotlib/issues/312</span>
<span class="sd">                    &quot;&quot;&quot;</span>
                <span class="p">)</span>
                <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s1">&#39;polar&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s1">&#39;polar&#39;</span><span class="p">)</span>

        <span class="c1"># radial lines</span>
        <span class="n">NN</span> <span class="o">=</span> <span class="n">ndgrid</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vectorNx</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">vectorNy</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="mi">0</span><span class="p">])[:,</span> <span class="p">:</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">NN</span> <span class="o">=</span> <span class="n">NN</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">vnN</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">vnN</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">2</span><span class="p">),</span> <span class="n">order</span><span class="o">=</span><span class="s1">&#39;F&#39;</span><span class="p">)</span>
        <span class="n">NN</span> <span class="o">=</span> <span class="p">[</span><span class="n">NN</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">NN</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">1</span><span class="p">]]</span>
        <span class="n">X1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">c_</span><span class="p">[</span>
            <span class="n">mkvc</span><span class="p">(</span><span class="n">NN</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]),</span>
            <span class="n">mkvc</span><span class="p">(</span><span class="n">NN</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="bp">self</span><span class="o">.</span><span class="n">nCx</span><span class="p">,</span> <span class="p">:]),</span>
            <span class="n">mkvc</span><span class="p">(</span><span class="n">NN</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">,</span> <span class="p">:])</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span>
        <span class="p">]</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
        <span class="n">Y1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">c_</span><span class="p">[</span>
            <span class="n">mkvc</span><span class="p">(</span><span class="n">NN</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]),</span>
            <span class="n">mkvc</span><span class="p">(</span><span class="n">NN</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="bp">self</span><span class="o">.</span><span class="n">nCx</span><span class="p">,</span> <span class="p">:]),</span>
            <span class="n">mkvc</span><span class="p">(</span><span class="n">NN</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">,</span> <span class="p">:])</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span>
        <span class="p">]</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>

        <span class="n">color</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;color&#39;</span><span class="p">,</span> <span class="s1">&#39;C0&#39;</span><span class="p">)</span>
        <span class="n">linewidth</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;linewidth&#39;</span><span class="p">,</span> <span class="mf">1.</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Y1</span><span class="p">,</span> <span class="n">X1</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="n">linewidth</span><span class="p">)</span>

        <span class="c1"># circles</span>
        <span class="n">n</span> <span class="o">=</span> <span class="mi">100</span>
        <span class="n">XY2</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
                <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mi">2</span><span class="p">,</span> <span class="n">n</span><span class="p">),</span> <span class="n">r</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">n</span><span class="p">),</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;-&quot;</span><span class="p">,</span>
                <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="n">linewidth</span>
            <span class="p">)</span>
            <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">vectorNx</span>
        <span class="p">]</span>

        <span class="k">return</span> <span class="n">ax</span>

<div class="viewcode-block" id="CylView.plotImage"><a class="viewcode-back" href="../../api/generated/discretize.View.CylView.html#discretize.CylView.plotImage">[docs]</a>    <span class="k">def</span> <span class="nf">plotImage</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_plotCylTensorMesh</span><span class="p">(</span><span class="s1">&#39;plotImage&#39;</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="CurviView"><a class="viewcode-back" href="../../api/generated/discretize.View.CurviView.html#discretize.CurviView">[docs]</a><span class="nd">@requires</span><span class="p">({</span><span class="s1">&#39;matplotlib&#39;</span><span class="p">:</span> <span class="n">matplotlib</span><span class="p">})</span>
<span class="k">class</span> <span class="nc">CurviView</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Provides viewing functions for CurvilinearMesh</span>

<span class="sd">    This class is inherited by CurvilinearMesh</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">pass</span>

<div class="viewcode-block" id="CurviView.plotGrid"><a class="viewcode-back" href="../../api/generated/discretize.View.CurviView.html#discretize.CurviView.plotGrid">[docs]</a>    <span class="k">def</span> <span class="nf">plotGrid</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">nodes</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">faces</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">centers</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">edges</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">lines</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">showIt</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Plot the nodal, cell-centered and staggered grids for 1, 2 and 3 dimensions.</span>


<span class="sd">        .. plot::</span>
<span class="sd">            :include-source:</span>

<span class="sd">            import discretize</span>
<span class="sd">            X, Y = discretize.utils.exampleLrmGrid([3, 3], &#39;rotate&#39;)</span>
<span class="sd">            M = discretize.CurvilinearMesh([X, Y])</span>
<span class="sd">            M.plotGrid(showIt=True)</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">axOpts</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;projection&#39;</span><span class="p">:</span> <span class="s1">&#39;3d&#39;</span><span class="p">}</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dim</span> <span class="o">==</span> <span class="mi">3</span> <span class="k">else</span> <span class="p">{}</span>
        <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">,</span> <span class="o">**</span><span class="n">axOpts</span><span class="p">)</span>

        <span class="n">NN</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gridN</span><span class="p">,</span> <span class="s1">&#39;N&#39;</span><span class="p">,</span> <span class="s1">&#39;N&#39;</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dim</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>

            <span class="k">if</span> <span class="n">lines</span><span class="p">:</span>
                <span class="n">X1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">c_</span><span class="p">[</span><span class="n">mkvc</span><span class="p">(</span><span class="n">NN</span><span class="p">[</span><span class="mi">0</span><span class="p">][:</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]),</span> <span class="n">mkvc</span><span class="p">(</span><span class="n">NN</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">:,</span> <span class="p">:]),</span> <span class="n">mkvc</span><span class="p">(</span><span class="n">NN</span><span class="p">[</span><span class="mi">0</span><span class="p">][:</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">:])</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">]</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
                <span class="n">Y1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">c_</span><span class="p">[</span><span class="n">mkvc</span><span class="p">(</span><span class="n">NN</span><span class="p">[</span><span class="mi">1</span><span class="p">][:</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]),</span> <span class="n">mkvc</span><span class="p">(</span><span class="n">NN</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">:,</span> <span class="p">:]),</span> <span class="n">mkvc</span><span class="p">(</span><span class="n">NN</span><span class="p">[</span><span class="mi">1</span><span class="p">][:</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">:])</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">]</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>

                <span class="n">X2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">c_</span><span class="p">[</span><span class="n">mkvc</span><span class="p">(</span><span class="n">NN</span><span class="p">[</span><span class="mi">0</span><span class="p">][:,</span> <span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]),</span> <span class="n">mkvc</span><span class="p">(</span><span class="n">NN</span><span class="p">[</span><span class="mi">0</span><span class="p">][:,</span> <span class="mi">1</span><span class="p">:]),</span> <span class="n">mkvc</span><span class="p">(</span><span class="n">NN</span><span class="p">[</span><span class="mi">0</span><span class="p">][:,</span> <span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">]</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
                <span class="n">Y2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">c_</span><span class="p">[</span><span class="n">mkvc</span><span class="p">(</span><span class="n">NN</span><span class="p">[</span><span class="mi">1</span><span class="p">][:,</span> <span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]),</span> <span class="n">mkvc</span><span class="p">(</span><span class="n">NN</span><span class="p">[</span><span class="mi">1</span><span class="p">][:,</span> <span class="mi">1</span><span class="p">:]),</span> <span class="n">mkvc</span><span class="p">(</span><span class="n">NN</span><span class="p">[</span><span class="mi">1</span><span class="p">][:,</span> <span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">]</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>

                <span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="n">X1</span><span class="p">,</span> <span class="n">X2</span><span class="p">]</span>
                <span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="n">Y1</span><span class="p">,</span> <span class="n">Y2</span><span class="p">]</span>

                <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;C0&quot;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">centers</span><span class="p">:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">gridCC</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">gridCC</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;C1&quot;</span><span class="p">,</span>
                    <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
                <span class="p">)</span>

            <span class="c1"># Nx = self.r(self.normals, &#39;F&#39;, &#39;Fx&#39;, &#39;V&#39;)</span>
            <span class="c1"># Ny = self.r(self.normals, &#39;F&#39;, &#39;Fy&#39;, &#39;V&#39;)</span>
            <span class="c1"># Tx = self.r(self.tangents, &#39;E&#39;, &#39;Ex&#39;, &#39;V&#39;)</span>
            <span class="c1"># Ty = self.r(self.tangents, &#39;E&#39;, &#39;Ey&#39;, &#39;V&#39;)</span>

            <span class="c1"># ax.plot(self.gridN[:, 0], self.gridN[:, 1], &#39;bo&#39;)</span>

            <span class="c1"># nX = np.c_[self.gridFx[:, 0], self.gridFx[:, 0] + Nx[0]*length, self.gridFx[:, 0]*np.nan].flatten()</span>
            <span class="c1"># nY = np.c_[self.gridFx[:, 1], self.gridFx[:, 1] + Nx[1]*length, self.gridFx[:, 1]*np.nan].flatten()</span>
            <span class="c1"># ax.plot(self.gridFx[:, 0], self.gridFx[:, 1], &#39;rs&#39;)</span>
            <span class="c1"># ax.plot(nX, nY, &#39;r-&#39;)</span>

            <span class="c1"># nX = np.c_[self.gridFy[:, 0], self.gridFy[:, 0] + Ny[0]*length, self.gridFy[:, 0]*np.nan].flatten()</span>
            <span class="c1"># nY = np.c_[self.gridFy[:, 1], self.gridFy[:, 1] + Ny[1]*length, self.gridFy[:, 1]*np.nan].flatten()</span>
            <span class="c1"># #ax.plot(self.gridFy[:, 0], self.gridFy[:, 1], &#39;gs&#39;)</span>
            <span class="c1"># ax.plot(nX, nY, &#39;g-&#39;)</span>

            <span class="c1"># tX = np.c_[self.gridEx[:, 0], self.gridEx[:, 0] + Tx[0]*length, self.gridEx[:, 0]*np.nan].flatten()</span>
            <span class="c1"># tY = np.c_[self.gridEx[:, 1], self.gridEx[:, 1] + Tx[1]*length, self.gridEx[:, 1]*np.nan].flatten()</span>
            <span class="c1"># ax.plot(self.gridEx[:, 0], self.gridEx[:, 1], &#39;r^&#39;)</span>
            <span class="c1"># ax.plot(tX, tY, &#39;r-&#39;)</span>

            <span class="c1"># nX = np.c_[self.gridEy[:, 0], self.gridEy[:, 0] + Ty[0]*length, self.gridEy[:, 0]*np.nan].flatten()</span>
            <span class="c1"># nY = np.c_[self.gridEy[:, 1], self.gridEy[:, 1] + Ty[1]*length, self.gridEy[:, 1]*np.nan].flatten()</span>
            <span class="c1"># #ax.plot(self.gridEy[:, 0], self.gridEy[:, 1], &#39;g^&#39;)</span>
            <span class="c1"># ax.plot(nX, nY, &#39;g-&#39;)</span>

        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">dim</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
            <span class="n">X1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">c_</span><span class="p">[</span><span class="n">mkvc</span><span class="p">(</span><span class="n">NN</span><span class="p">[</span><span class="mi">0</span><span class="p">][:</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:]),</span> <span class="n">mkvc</span><span class="p">(</span><span class="n">NN</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">:,</span> <span class="p">:,</span> <span class="p">:]),</span> <span class="n">mkvc</span><span class="p">(</span><span class="n">NN</span><span class="p">[</span><span class="mi">0</span><span class="p">][:</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:])</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">]</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
            <span class="n">Y1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">c_</span><span class="p">[</span><span class="n">mkvc</span><span class="p">(</span><span class="n">NN</span><span class="p">[</span><span class="mi">1</span><span class="p">][:</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:]),</span> <span class="n">mkvc</span><span class="p">(</span><span class="n">NN</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">:,</span> <span class="p">:,</span> <span class="p">:]),</span> <span class="n">mkvc</span><span class="p">(</span><span class="n">NN</span><span class="p">[</span><span class="mi">1</span><span class="p">][:</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:])</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">]</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
            <span class="n">Z1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">c_</span><span class="p">[</span><span class="n">mkvc</span><span class="p">(</span><span class="n">NN</span><span class="p">[</span><span class="mi">2</span><span class="p">][:</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:]),</span> <span class="n">mkvc</span><span class="p">(</span><span class="n">NN</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">1</span><span class="p">:,</span> <span class="p">:,</span> <span class="p">:]),</span> <span class="n">mkvc</span><span class="p">(</span><span class="n">NN</span><span class="p">[</span><span class="mi">2</span><span class="p">][:</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:])</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">]</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>

            <span class="n">X2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">c_</span><span class="p">[</span><span class="n">mkvc</span><span class="p">(</span><span class="n">NN</span><span class="p">[</span><span class="mi">0</span><span class="p">][:,</span> <span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]),</span> <span class="n">mkvc</span><span class="p">(</span><span class="n">NN</span><span class="p">[</span><span class="mi">0</span><span class="p">][:,</span> <span class="mi">1</span><span class="p">:,</span> <span class="p">:]),</span> <span class="n">mkvc</span><span class="p">(</span><span class="n">NN</span><span class="p">[</span><span class="mi">0</span><span class="p">][:,</span> <span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">:])</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">]</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
            <span class="n">Y2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">c_</span><span class="p">[</span><span class="n">mkvc</span><span class="p">(</span><span class="n">NN</span><span class="p">[</span><span class="mi">1</span><span class="p">][:,</span> <span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]),</span> <span class="n">mkvc</span><span class="p">(</span><span class="n">NN</span><span class="p">[</span><span class="mi">1</span><span class="p">][:,</span> <span class="mi">1</span><span class="p">:,</span> <span class="p">:]),</span> <span class="n">mkvc</span><span class="p">(</span><span class="n">NN</span><span class="p">[</span><span class="mi">1</span><span class="p">][:,</span> <span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">:])</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">]</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
            <span class="n">Z2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">c_</span><span class="p">[</span><span class="n">mkvc</span><span class="p">(</span><span class="n">NN</span><span class="p">[</span><span class="mi">2</span><span class="p">][:,</span> <span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]),</span> <span class="n">mkvc</span><span class="p">(</span><span class="n">NN</span><span class="p">[</span><span class="mi">2</span><span class="p">][:,</span> <span class="mi">1</span><span class="p">:,</span> <span class="p">:]),</span> <span class="n">mkvc</span><span class="p">(</span><span class="n">NN</span><span class="p">[</span><span class="mi">2</span><span class="p">][:,</span> <span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">:])</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">]</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>

            <span class="n">X3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">c_</span><span class="p">[</span><span class="n">mkvc</span><span class="p">(</span><span class="n">NN</span><span class="p">[</span><span class="mi">0</span><span class="p">][:,</span> <span class="p">:,</span> <span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]),</span> <span class="n">mkvc</span><span class="p">(</span><span class="n">NN</span><span class="p">[</span><span class="mi">0</span><span class="p">][:,</span> <span class="p">:,</span> <span class="mi">1</span><span class="p">:]),</span> <span class="n">mkvc</span><span class="p">(</span><span class="n">NN</span><span class="p">[</span><span class="mi">0</span><span class="p">][:,</span> <span class="p">:,</span> <span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">]</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
            <span class="n">Y3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">c_</span><span class="p">[</span><span class="n">mkvc</span><span class="p">(</span><span class="n">NN</span><span class="p">[</span><span class="mi">1</span><span class="p">][:,</span> <span class="p">:,</span> <span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]),</span> <span class="n">mkvc</span><span class="p">(</span><span class="n">NN</span><span class="p">[</span><span class="mi">1</span><span class="p">][:,</span> <span class="p">:,</span> <span class="mi">1</span><span class="p">:]),</span> <span class="n">mkvc</span><span class="p">(</span><span class="n">NN</span><span class="p">[</span><span class="mi">1</span><span class="p">][:,</span> <span class="p">:,</span> <span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">]</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
            <span class="n">Z3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">c_</span><span class="p">[</span><span class="n">mkvc</span><span class="p">(</span><span class="n">NN</span><span class="p">[</span><span class="mi">2</span><span class="p">][:,</span> <span class="p">:,</span> <span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]),</span> <span class="n">mkvc</span><span class="p">(</span><span class="n">NN</span><span class="p">[</span><span class="mi">2</span><span class="p">][:,</span> <span class="p">:,</span> <span class="mi">1</span><span class="p">:]),</span> <span class="n">mkvc</span><span class="p">(</span><span class="n">NN</span><span class="p">[</span><span class="mi">2</span><span class="p">][:,</span> <span class="p">:,</span> <span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">]</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>

            <span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="n">X1</span><span class="p">,</span> <span class="n">X2</span><span class="p">,</span> <span class="n">X3</span><span class="p">]</span>
            <span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="n">Y1</span><span class="p">,</span> <span class="n">Y2</span><span class="p">,</span> <span class="n">Y3</span><span class="p">]</span>
            <span class="n">Z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="n">Z1</span><span class="p">,</span> <span class="n">Z2</span><span class="p">,</span> <span class="n">Z3</span><span class="p">]</span>

            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="s1">&#39;C0&#39;</span><span class="p">,</span> <span class="n">zs</span><span class="o">=</span><span class="n">Z</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_zlabel</span><span class="p">(</span><span class="s1">&#39;x3&#39;</span><span class="p">)</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x1&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;x2&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">showIt</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">ax</span></div>

<div class="viewcode-block" id="CurviView.plotImage"><a class="viewcode-back" href="../../api/generated/discretize.View.CurviView.html#discretize.CurviView.plotImage">[docs]</a>    <span class="k">def</span> <span class="nf">plotImage</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">I</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">showIt</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">clim</span><span class="o">=</span><span class="kc">None</span>
    <span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dim</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s1">&#39;This is not yet done!&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>

        <span class="n">jet</span> <span class="o">=</span> <span class="n">cm</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="s1">&#39;jet&#39;</span><span class="p">)</span>
        <span class="n">cNorm</span>  <span class="o">=</span> <span class="n">colors</span><span class="o">.</span><span class="n">Normalize</span><span class="p">(</span>
            <span class="n">vmin</span><span class="o">=</span><span class="n">I</span><span class="o">.</span><span class="n">min</span><span class="p">()</span> <span class="k">if</span> <span class="n">clim</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">clim</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="n">vmax</span><span class="o">=</span><span class="n">I</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="k">if</span> <span class="n">clim</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">clim</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

        <span class="n">scalarMap</span> <span class="o">=</span> <span class="n">cmx</span><span class="o">.</span><span class="n">ScalarMappable</span><span class="p">(</span><span class="n">norm</span><span class="o">=</span><span class="n">cNorm</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">jet</span><span class="p">)</span>
        <span class="c1"># ax.set_xlim((self.x0[0], self.h[0].sum()))</span>
        <span class="c1"># ax.set_ylim((self.x0[1], self.h[1].sum()))</span>

        <span class="n">Nx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gridN</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;N&#39;</span><span class="p">,</span> <span class="s1">&#39;N&#39;</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">)</span>
        <span class="n">Ny</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gridN</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;N&#39;</span><span class="p">,</span> <span class="s1">&#39;N&#39;</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">)</span>
        <span class="n">cell</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="p">(</span><span class="n">I</span><span class="p">,</span> <span class="s1">&#39;CC&#39;</span><span class="p">,</span> <span class="s1">&#39;CC&#39;</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nCx</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">jj</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nCy</span><span class="p">):</span>
                <span class="n">I</span> <span class="o">=</span> <span class="p">[</span><span class="n">ii</span><span class="p">,</span> <span class="n">ii</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">ii</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">ii</span><span class="p">]</span>
                <span class="n">J</span> <span class="o">=</span> <span class="p">[</span><span class="n">jj</span><span class="p">,</span> <span class="n">jj</span><span class="p">,</span> <span class="n">jj</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">jj</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">Polygon</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">c_</span><span class="p">[</span><span class="n">Nx</span><span class="p">[</span><span class="n">I</span><span class="p">,</span> <span class="n">J</span><span class="p">],</span> <span class="n">Ny</span><span class="p">[</span><span class="n">I</span><span class="p">,</span> <span class="n">J</span><span class="p">]],</span> <span class="n">facecolor</span><span class="o">=</span><span class="n">scalarMap</span><span class="o">.</span><span class="n">to_rgba</span><span class="p">(</span><span class="n">cell</span><span class="p">[</span><span class="n">ii</span><span class="p">,</span> <span class="n">jj</span><span class="p">]),</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;k&#39;</span> <span class="k">if</span> <span class="n">grid</span> <span class="k">else</span> <span class="s1">&#39;none&#39;</span><span class="p">))</span>

        <span class="n">scalarMap</span><span class="o">.</span><span class="n">_A</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># http://stackoverflow.com/questions/8342549/matplotlib-add-colorbar-to-a-sequence-of-line-plots</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">showIt</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">scalarMap</span><span class="p">]</span></div></div>


<div class="viewcode-block" id="Slicer"><a class="viewcode-back" href="../../api/generated/discretize.View.Slicer.html#discretize.Slicer">[docs]</a><span class="nd">@requires</span><span class="p">({</span><span class="s1">&#39;matplotlib&#39;</span><span class="p">:</span> <span class="n">matplotlib</span><span class="p">})</span>
<span class="k">class</span> <span class="nc">Slicer</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Plot slices of a 3D volume, interactively (scroll wheel).</span>

<span class="sd">    If called from a notebook, make sure to set</span>

<span class="sd">        %matplotlib notebook</span>

<span class="sd">    The straight forward usage for the Slicer is through, e.g., a</span>
<span class="sd">    `TensorMesh`-mesh, by accessing its `mesh.plot_3d_slicer`.</span>

<span class="sd">    If you, however, call this class directly, you have first to initiate a</span>
<span class="sd">    figure, and afterwards connect it:</span>

<span class="sd">    &gt;&gt;&gt; # You have to initialize a figure</span>
<span class="sd">    &gt;&gt;&gt; fig = plt.figure()</span>
<span class="sd">    &gt;&gt;&gt; # Then you have to get the tracker from the Slicer</span>
<span class="sd">    &gt;&gt;&gt; tracker = discretize.View.Slicer(mesh, Lpout)</span>
<span class="sd">    &gt;&gt;&gt; # Finally you have to connect the tracker to the figure</span>
<span class="sd">    &gt;&gt;&gt; fig.canvas.mpl_connect(&#39;scroll_event&#39;, tracker.onscroll)</span>
<span class="sd">    &gt;&gt;&gt; plt.show()</span>


<span class="sd">    **Parameters**</span>

<span class="sd">    v : array</span>
<span class="sd">        Data array of length self.nC.</span>

<span class="sd">    xslice, yslice, zslice : floats, optional</span>
<span class="sd">        Initial slice locations (in meter);</span>
<span class="sd">        defaults to the middle of the volume.</span>

<span class="sd">    vType: str</span>
<span class="sd">        Type of visualization. Default is &#39;CC&#39;.</span>
<span class="sd">        One of [&#39;CC&#39;, &#39;Fx&#39;, &#39;Fy&#39;, &#39;Fz&#39;, &#39;Ex&#39;, &#39;Ey&#39;, &#39;Ez&#39;].</span>

<span class="sd">    view : str</span>
<span class="sd">        Which component to show. Defaults to &#39;real&#39;.</span>
<span class="sd">        One of  [&#39;real&#39;, &#39;imag&#39;, &#39;abs&#39;].</span>

<span class="sd">    axis : &#39;xy&#39; (default) or &#39;yx&#39;</span>
<span class="sd">        &#39;xy&#39;: horizontal axis is x, vertical axis is y. Reversed otherwise.</span>

<span class="sd">    transparent : &#39;slider&#39; or list of floats or pairs of floats, optional</span>
<span class="sd">        Values to be removed. E.g. air, water.</span>
<span class="sd">        If single value, only exact matches are removed. Pairs are treated as</span>
<span class="sd">        ranges. E.g. [0.3, [1, 4], [-np.infty, -10]] removes all values equal</span>
<span class="sd">        to 0.3, all values between 1 and 4, and all values smaller than -10.</span>
<span class="sd">        If &#39;slider&#39; is provided it will plot an interactive slider to choose</span>
<span class="sd">        the shown range.</span>

<span class="sd">    clim : None or list of [min, max]</span>
<span class="sd">        For pcolormesh (vmin, vmax).</span>

<span class="sd">    xlim, ylim, zlim : None or list of [min, max]</span>
<span class="sd">        Axis limits.</span>

<span class="sd">    aspect : &#39;auto&#39;, &#39;equal&#39;, or num</span>
<span class="sd">        Aspect ratio of subplots. Defaults to &#39;auto&#39;.</span>

<span class="sd">        A list of two values can be provided. The first will be for the</span>
<span class="sd">        XY-plot, the second for the XZ- and YZ-plots, e.g. [&#39;equal&#39;, 2] to have</span>
<span class="sd">        the vertical dimension exaggerated by a factor of 2.</span>

<span class="sd">        WARNING: For anything else than &#39;auto&#39;, unexpected things might happen</span>
<span class="sd">                 when zooming, and the subplot-arrangement won&#39;t look pretty.</span>

<span class="sd">    grid : list of 3 int</span>
<span class="sd">        Number of cells occupied by x, y, and z dimension on plt.subplot2grid.</span>

<span class="sd">    pcolorOpts : dictionary</span>
<span class="sd">        Passed to pcolormesh.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mesh</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">xslice</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">yslice</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">zslice</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">vType</span><span class="o">=</span><span class="s1">&#39;CC&#39;</span><span class="p">,</span> <span class="n">view</span><span class="o">=</span><span class="s1">&#39;real&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;xy&#39;</span><span class="p">,</span> <span class="n">transparent</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">clim</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">xlim</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ylim</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">zlim</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">aspect</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span>
                 <span class="n">grid</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">pcolorOpts</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Initialize interactive figure.&quot;&quot;&quot;</span>

        <span class="c1"># 0. Some checks, not very extensive</span>

        <span class="c1"># (a) Mesh dimensionality</span>
        <span class="k">if</span> <span class="n">mesh</span><span class="o">.</span><span class="n">dim</span> <span class="o">!=</span> <span class="mi">3</span><span class="p">:</span>
            <span class="n">err</span> <span class="o">=</span> <span class="s1">&#39;Must be a 3D mesh. Use plotImage instead.&#39;</span>
            <span class="n">err</span> <span class="o">+=</span> <span class="s1">&#39; Mesh provided has </span><span class="si">{}</span><span class="s1"> dimension(s).&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">mesh</span><span class="o">.</span><span class="n">dim</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>

        <span class="c1"># (b) vType  # Not yet working for [&#39;CCv&#39;]</span>
        <span class="n">vTypeOpts</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;CC&#39;</span><span class="p">,</span> <span class="s1">&#39;Fx&#39;</span><span class="p">,</span> <span class="s1">&#39;Fy&#39;</span><span class="p">,</span> <span class="s1">&#39;Fz&#39;</span><span class="p">,</span> <span class="s1">&#39;Ex&#39;</span><span class="p">,</span> <span class="s1">&#39;Ey&#39;</span><span class="p">,</span> <span class="s1">&#39;Ez&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">vType</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">vTypeOpts</span><span class="p">:</span>
            <span class="n">err</span> <span class="o">=</span> <span class="s2">&quot;vType must be in [&#39;</span><span class="si">{0!s}</span><span class="s2">&#39;].&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;&#39;, &#39;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">vTypeOpts</span><span class="p">))</span>
            <span class="n">err</span> <span class="o">+=</span> <span class="s2">&quot; vType provided: &#39;</span><span class="si">{0!s}</span><span class="s2">&#39;.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">vType</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">vType</span> <span class="o">!=</span> <span class="s1">&#39;CC&#39;</span><span class="p">:</span>
            <span class="n">aveOp</span> <span class="o">=</span> <span class="s1">&#39;ave&#39;</span> <span class="o">+</span> <span class="n">vType</span> <span class="o">+</span> <span class="s1">&#39;2CC&#39;</span>
            <span class="n">Av</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">aveOp</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">v</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="n">Av</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
                <span class="n">v</span> <span class="o">=</span> <span class="n">Av</span> <span class="o">*</span> <span class="n">v</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">v</span> <span class="o">=</span> <span class="n">mesh</span><span class="o">.</span><span class="n">r</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">vType</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">vType</span><span class="p">)</span> <span class="c1"># get specific component</span>
                <span class="n">v</span> <span class="o">=</span> <span class="n">Av</span> <span class="o">*</span> <span class="n">v</span>

        <span class="c1"># (c) vOpts  # Not yet working for &#39;vec&#39;</span>

        <span class="c1"># Backwards compatibility</span>
        <span class="k">if</span> <span class="n">view</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;xy&#39;</span><span class="p">,</span> <span class="s1">&#39;yx&#39;</span><span class="p">]:</span>
            <span class="n">axis</span> <span class="o">=</span> <span class="n">view</span>
            <span class="n">view</span> <span class="o">=</span> <span class="s1">&#39;real&#39;</span>

        <span class="n">viewOpts</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;real&#39;</span><span class="p">,</span> <span class="s1">&#39;imag&#39;</span><span class="p">,</span> <span class="s1">&#39;abs&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">view</span> <span class="ow">in</span> <span class="n">viewOpts</span><span class="p">:</span>
            <span class="n">v</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">np</span><span class="p">,</span> <span class="n">view</span><span class="p">)(</span><span class="n">v</span><span class="p">)</span> <span class="c1"># e.g. np.real(v)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">err</span> <span class="o">=</span> <span class="s2">&quot;view must be in [&#39;</span><span class="si">{0!s}</span><span class="s2">&#39;].&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;&#39;, &#39;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">viewOpts</span><span class="p">))</span>
            <span class="n">err</span> <span class="o">+=</span> <span class="s2">&quot; view provided: &#39;</span><span class="si">{0!s}</span><span class="s2">&#39;.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">view</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>

        <span class="c1"># 1. Store relevant data</span>

        <span class="c1"># Store data in self as (nx, ny, nz)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">v</span> <span class="o">=</span> <span class="n">mesh</span><span class="o">.</span><span class="n">r</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">mesh</span><span class="o">.</span><span class="n">nC</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">order</span><span class="o">=</span><span class="s1">&#39;F&#39;</span><span class="p">),</span> <span class="s1">&#39;CC&#39;</span><span class="p">,</span> <span class="s1">&#39;CC&#39;</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">masked_where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">v</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">v</span><span class="p">)</span>

        <span class="c1"># Store relevant information from mesh in self</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">mesh</span><span class="o">.</span><span class="n">vectorNx</span>    <span class="c1"># x-node locations</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">mesh</span><span class="o">.</span><span class="n">vectorNy</span>    <span class="c1"># y-node locations</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">z</span> <span class="o">=</span> <span class="n">mesh</span><span class="o">.</span><span class="n">vectorNz</span>    <span class="c1"># z-node locations</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">xc</span> <span class="o">=</span> <span class="n">mesh</span><span class="o">.</span><span class="n">vectorCCx</span>  <span class="c1"># x-cell center locations</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">yc</span> <span class="o">=</span> <span class="n">mesh</span><span class="o">.</span><span class="n">vectorCCy</span>  <span class="c1"># y-cell center locations</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">zc</span> <span class="o">=</span> <span class="n">mesh</span><span class="o">.</span><span class="n">vectorCCz</span>  <span class="c1"># z-cell center locations</span>

        <span class="c1"># Axis: Default (&#39;xy&#39;): horizontal axis is x, vertical axis is y.</span>
        <span class="c1"># Reversed otherwise.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">yx</span> <span class="o">=</span> <span class="n">axis</span> <span class="o">==</span> <span class="s1">&#39;yx&#39;</span>

        <span class="c1"># Store initial slice indices; if not provided, takes the middle.</span>
        <span class="k">if</span> <span class="n">xslice</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">xind</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xc</span> <span class="o">-</span> <span class="n">xslice</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">xind</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">xc</span><span class="o">.</span><span class="n">size</span> <span class="o">//</span> <span class="mi">2</span>
        <span class="k">if</span> <span class="n">xslice</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">yind</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">yc</span> <span class="o">-</span> <span class="n">yslice</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">yind</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">yc</span><span class="o">.</span><span class="n">size</span> <span class="o">//</span> <span class="mi">2</span>
        <span class="k">if</span> <span class="n">zslice</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">zind</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">zc</span> <span class="o">-</span> <span class="n">zslice</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">zind</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">zc</span><span class="o">.</span><span class="n">size</span> <span class="o">//</span> <span class="mi">2</span>

        <span class="c1"># Aspect ratio</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">aspect</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)):</span>
            <span class="n">aspect1</span> <span class="o">=</span> <span class="n">aspect</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">aspect2</span> <span class="o">=</span> <span class="n">aspect</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">aspect1</span> <span class="o">=</span> <span class="n">aspect</span>
            <span class="n">aspect2</span> <span class="o">=</span> <span class="n">aspect</span>
        <span class="k">if</span> <span class="n">aspect2</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span> <span class="s1">&#39;equal&#39;</span><span class="p">]:</span>
            <span class="n">aspect3</span> <span class="o">=</span> <span class="n">aspect2</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">aspect3</span> <span class="o">=</span> <span class="mf">1.0</span><span class="o">/</span><span class="n">aspect2</span>

        <span class="c1"># Store min and max of all data</span>
        <span class="k">if</span> <span class="n">clim</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">clim</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">nanmin</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">v</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmax</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">v</span><span class="p">)]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pc_props</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;vmin&#39;</span><span class="p">:</span> <span class="n">clim</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;vmax&#39;</span><span class="p">:</span> <span class="n">clim</span><span class="p">[</span><span class="mi">1</span><span class="p">]}</span>

        <span class="c1"># 2. Start populating figure</span>

        <span class="c1"># Get plot2grid dimension</span>
        <span class="n">figgrid</span> <span class="o">=</span> <span class="p">(</span><span class="n">grid</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">grid</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">grid</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">grid</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>

        <span class="c1"># Create subplots</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gcf</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">wspace</span><span class="o">=.</span><span class="mi">075</span><span class="p">,</span> <span class="n">hspace</span><span class="o">=.</span><span class="mi">1</span><span class="p">)</span>

        <span class="c1"># X-Y</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot2grid</span><span class="p">(</span><span class="n">figgrid</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">colspan</span><span class="o">=</span><span class="n">grid</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                                    <span class="n">rowspan</span><span class="o">=</span><span class="n">grid</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">aspect</span><span class="o">=</span><span class="n">aspect1</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">yx</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">ylim</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ax1</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="n">ylim</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ylim</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span>
            <span class="k">if</span> <span class="n">xlim</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ax1</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="n">xlim</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">xlim</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">xlim</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ax1</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="n">xlim</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">xlim</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span>
            <span class="k">if</span> <span class="n">ylim</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ax1</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="n">ylim</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ylim</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax1</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s1">&#39;top&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ax1</span><span class="o">.</span><span class="n">get_xticklabels</span><span class="p">(),</span> <span class="n">visible</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

        <span class="c1"># X-Z</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax2</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot2grid</span><span class="p">(</span><span class="n">figgrid</span><span class="p">,</span> <span class="p">(</span><span class="n">grid</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">0</span><span class="p">),</span> <span class="n">colspan</span><span class="o">=</span><span class="n">grid</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                                    <span class="n">rowspan</span><span class="o">=</span><span class="n">grid</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">sharex</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ax1</span><span class="p">,</span>
                                    <span class="n">aspect</span><span class="o">=</span><span class="n">aspect2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax2</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s1">&#39;both&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">yx</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">ylim</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ax2</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="n">ylim</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ylim</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">xlim</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ax2</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="n">xlim</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">xlim</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;z&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">zlim</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ax2</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="n">zlim</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">zlim</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span>

        <span class="c1"># Z-Y</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax3</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot2grid</span><span class="p">(</span><span class="n">figgrid</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">grid</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="n">colspan</span><span class="o">=</span><span class="n">grid</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
                                    <span class="n">rowspan</span><span class="o">=</span><span class="n">grid</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">sharey</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ax1</span><span class="p">,</span>
                                    <span class="n">aspect</span><span class="o">=</span><span class="n">aspect3</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax3</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s1">&#39;right&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax3</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s1">&#39;both&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax3</span><span class="o">.</span><span class="n">invert_xaxis</span><span class="p">()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ax3</span><span class="o">.</span><span class="n">get_yticklabels</span><span class="p">(),</span> <span class="n">visible</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">yx</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">xlim</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ax3</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="n">xlim</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">xlim</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">ylim</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ax3</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="n">ylim</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ylim</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span>
        <span class="k">if</span> <span class="n">zlim</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ax3</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="n">zlim</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">zlim</span><span class="p">[</span><span class="mi">0</span><span class="p">]])</span>

        <span class="c1"># Cross-line properties</span>
        <span class="c1"># We have to lines, a thick white one, and in the middle a thin black</span>
        <span class="c1"># one, to assure that the lines can be seen on dark and on bright</span>
        <span class="c1"># spots.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">clpropsw</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="s1">&#39;lw&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;zorder&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">clpropsk</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="s1">&#39;lw&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;zorder&#39;</span><span class="p">:</span> <span class="mi">11</span><span class="p">}</span>

        <span class="c1"># Add pcolorOpts</span>
        <span class="k">if</span> <span class="n">pcolorOpts</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pc_props</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">pcolorOpts</span><span class="p">)</span>

        <span class="c1"># Initial draw</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_xy</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_xz</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_zy</span><span class="p">()</span>

        <span class="c1"># Create colorbar</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">zy_pc</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.15</span><span class="p">)</span>

        <span class="c1"># Remove transparent value</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">transparent</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">and</span> <span class="n">transparent</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;slider&#39;</span><span class="p">:</span>
            <span class="c1"># Sliders</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ax_smin</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">axes</span><span class="p">([</span><span class="mf">0.7</span><span class="p">,</span> <span class="mf">0.11</span><span class="p">,</span> <span class="mf">0.15</span><span class="p">,</span> <span class="mf">0.03</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ax_smax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">axes</span><span class="p">([</span><span class="mf">0.7</span><span class="p">,</span> <span class="mf">0.15</span><span class="p">,</span> <span class="mf">0.15</span><span class="p">,</span> <span class="mf">0.03</span><span class="p">])</span>

            <span class="c1"># Limits slightly below/above actual limits, clips otherwise</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">smin</span> <span class="o">=</span> <span class="n">Slider</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ax_smin</span><span class="p">,</span> <span class="s1">&#39;Min&#39;</span><span class="p">,</span> <span class="o">*</span><span class="n">clim</span><span class="p">,</span> <span class="n">valinit</span><span class="o">=</span><span class="n">clim</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">smax</span> <span class="o">=</span> <span class="n">Slider</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ax_smax</span><span class="p">,</span> <span class="s1">&#39;Max&#39;</span><span class="p">,</span> <span class="o">*</span><span class="n">clim</span><span class="p">,</span> <span class="n">valinit</span><span class="o">=</span><span class="n">clim</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

            <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="n">val</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">v</span><span class="o">.</span><span class="n">mask</span> <span class="o">=</span> <span class="kc">False</span>  <span class="c1"># Re-set</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">masked_outside</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">v</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">smin</span><span class="o">.</span><span class="n">val</span><span class="p">,</span>
                                              <span class="bp">self</span><span class="o">.</span><span class="n">smax</span><span class="o">.</span><span class="n">val</span><span class="p">)</span>
                <span class="c1"># Update plots</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">update_xy</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">update_xz</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">update_zy</span><span class="p">()</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">smax</span><span class="o">.</span><span class="n">on_changed</span><span class="p">(</span><span class="n">update</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">smin</span><span class="o">.</span><span class="n">on_changed</span><span class="p">(</span><span class="n">update</span><span class="p">)</span>

        <span class="k">elif</span> <span class="n">transparent</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>

            <span class="c1"># Loop over values</span>
            <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">transparent</span><span class="p">:</span>
                <span class="c1"># If value is a list/tuple, we treat is as a range</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">masked_inside</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">v</span><span class="p">,</span> <span class="n">value</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">value</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                <span class="k">else</span><span class="p">:</span> <span class="c1"># Exact value</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">masked_equal</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">v</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

            <span class="c1"># Update plots</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">update_xy</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">update_xz</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">update_zy</span><span class="p">()</span>

        <span class="c1"># 3. Keep depth in X-Z and Z-Y in sync</span>

        <span class="k">def</span> <span class="nf">do_adjust</span><span class="p">():</span>
            <span class="sd">&quot;&quot;&quot;Return True if z-axis in X-Z and Z-Y are different.&quot;&quot;&quot;</span>
            <span class="n">one</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ax2</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">())</span>
            <span class="n">two</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ax3</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">())[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">return</span> <span class="nb">sum</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">one</span> <span class="o">-</span> <span class="n">two</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mf">0.001</span>  <span class="c1"># Difference at least 1 m.</span>

        <span class="k">def</span> <span class="nf">on_ylims_changed</span><span class="p">(</span><span class="n">ax</span><span class="p">):</span>
            <span class="sd">&quot;&quot;&quot;Adjust Z-Y if X-Z changed.&quot;&quot;&quot;</span>
            <span class="k">if</span> <span class="n">do_adjust</span><span class="p">():</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ax3</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">ax2</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()[</span><span class="mi">1</span><span class="p">],</span>
                                   <span class="bp">self</span><span class="o">.</span><span class="n">ax2</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()[</span><span class="mi">0</span><span class="p">]])</span>

        <span class="k">def</span> <span class="nf">on_xlims_changed</span><span class="p">(</span><span class="n">ax</span><span class="p">):</span>
            <span class="sd">&quot;&quot;&quot;Adjust X-Z if Z-Y changed.&quot;&quot;&quot;</span>
            <span class="k">if</span> <span class="n">do_adjust</span><span class="p">():</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ax2</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">ax3</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">()[</span><span class="mi">1</span><span class="p">],</span>
                                   <span class="bp">self</span><span class="o">.</span><span class="n">ax3</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">()[</span><span class="mi">0</span><span class="p">]])</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">ax3</span><span class="o">.</span><span class="n">callbacks</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s1">&#39;xlim_changed&#39;</span><span class="p">,</span> <span class="n">on_xlims_changed</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax2</span><span class="o">.</span><span class="n">callbacks</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s1">&#39;ylim_changed&#39;</span><span class="p">,</span> <span class="n">on_ylims_changed</span><span class="p">)</span>

<div class="viewcode-block" id="Slicer.onscroll"><a class="viewcode-back" href="../../api/generated/discretize.View.Slicer.html#discretize.Slicer.onscroll">[docs]</a>    <span class="k">def</span> <span class="nf">onscroll</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Update index and data when scrolling.&quot;&quot;&quot;</span>

        <span class="c1"># Get scroll direction</span>
        <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">button</span> <span class="o">==</span> <span class="s1">&#39;up&#39;</span><span class="p">:</span>
            <span class="n">pm</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">pm</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>

        <span class="c1"># Update slice index depending on subplot over which mouse is</span>
        <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">inaxes</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax1</span><span class="p">:</span>    <span class="c1"># X-Y</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">zind</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">zind</span> <span class="o">+</span> <span class="n">pm</span><span class="p">)</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">zc</span><span class="o">.</span><span class="n">size</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">update_xy</span><span class="p">()</span>
        <span class="k">elif</span> <span class="n">event</span><span class="o">.</span><span class="n">inaxes</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax2</span><span class="p">:</span>  <span class="c1"># X-Z</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">yx</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">xind</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xind</span> <span class="o">+</span> <span class="n">pm</span><span class="p">)</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">xc</span><span class="o">.</span><span class="n">size</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">yind</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">yind</span> <span class="o">+</span> <span class="n">pm</span><span class="p">)</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">yc</span><span class="o">.</span><span class="n">size</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">update_xz</span><span class="p">()</span>
        <span class="k">elif</span> <span class="n">event</span><span class="o">.</span><span class="n">inaxes</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax3</span><span class="p">:</span>  <span class="c1"># Z-Y</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">yx</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">yind</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">yind</span> <span class="o">+</span> <span class="n">pm</span><span class="p">)</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">yc</span><span class="o">.</span><span class="n">size</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">xind</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xind</span> <span class="o">+</span> <span class="n">pm</span><span class="p">)</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">xc</span><span class="o">.</span><span class="n">size</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">update_zy</span><span class="p">()</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span></div>

<div class="viewcode-block" id="Slicer.update_xy"><a class="viewcode-back" href="../../api/generated/discretize.View.Slicer.html#discretize.Slicer.update_xy">[docs]</a>    <span class="k">def</span> <span class="nf">update_xy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Update plot for change in Z-index.&quot;&quot;&quot;</span>

        <span class="c1"># Clean up</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_clear_elements</span><span class="p">([</span><span class="s1">&#39;xy_pc&#39;</span><span class="p">,</span> <span class="s1">&#39;xz_ahw&#39;</span><span class="p">,</span> <span class="s1">&#39;xz_ahk&#39;</span><span class="p">,</span> <span class="s1">&#39;zy_avw&#39;</span><span class="p">,</span> <span class="s1">&#39;zy_avk&#39;</span><span class="p">])</span>

        <span class="c1"># Draw X-Y slice</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">yx</span><span class="p">:</span>
            <span class="n">zdat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">rot90</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">v</span><span class="p">[:,</span> <span class="p">:,</span> <span class="bp">self</span><span class="o">.</span><span class="n">zind</span><span class="p">]</span><span class="o">.</span><span class="n">transpose</span><span class="p">())</span>
            <span class="n">hor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span>
            <span class="n">ver</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">zdat</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">v</span><span class="p">[:,</span> <span class="p">:,</span> <span class="bp">self</span><span class="o">.</span><span class="n">zind</span><span class="p">]</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
            <span class="n">hor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span>
            <span class="n">ver</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">xy_pc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax1</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">hor</span><span class="p">,</span> <span class="n">ver</span><span class="p">,</span> <span class="n">zdat</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">pc_props</span><span class="p">)</span>

        <span class="c1"># Draw Z-slice intersection in X-Z plot</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">xz_ahw</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax2</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">zc</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">zind</span><span class="p">],</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">clpropsw</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">xz_ahk</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax2</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">zc</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">zind</span><span class="p">],</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">clpropsk</span><span class="p">)</span>

        <span class="c1"># Draw Z-slice intersection in Z-Y plot</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">zy_avw</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax3</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">zc</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">zind</span><span class="p">],</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">clpropsw</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">zy_avk</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax3</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">zc</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">zind</span><span class="p">],</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">clpropsk</span><span class="p">)</span></div>

<div class="viewcode-block" id="Slicer.update_xz"><a class="viewcode-back" href="../../api/generated/discretize.View.Slicer.html#discretize.Slicer.update_xz">[docs]</a>    <span class="k">def</span> <span class="nf">update_xz</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Update plot for change in Y-index.&quot;&quot;&quot;</span>

        <span class="c1"># Clean up</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_clear_elements</span><span class="p">([</span><span class="s1">&#39;xz_pc&#39;</span><span class="p">,</span> <span class="s1">&#39;zy_ahk&#39;</span><span class="p">,</span> <span class="s1">&#39;zy_ahw&#39;</span><span class="p">,</span> <span class="s1">&#39;xy_ahk&#39;</span><span class="p">,</span> <span class="s1">&#39;xy_ahw&#39;</span><span class="p">])</span>

        <span class="c1"># Draw X-Z slice</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">yx</span><span class="p">:</span>
            <span class="n">ydat</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">v</span><span class="p">[</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">xind</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:]</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
            <span class="n">hor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span>
            <span class="n">ver</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">z</span>
            <span class="n">ind</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">xc</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">xind</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ydat</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">v</span><span class="p">[:,</span> <span class="bp">self</span><span class="o">.</span><span class="n">yind</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
            <span class="n">hor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span>
            <span class="n">ver</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">z</span>
            <span class="n">ind</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">yc</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">yind</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">xz_pc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax2</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">hor</span><span class="p">,</span> <span class="n">ver</span><span class="p">,</span> <span class="n">ydat</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">pc_props</span><span class="p">)</span>

        <span class="c1"># Draw X-slice intersection in X-Y plot</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">xy_ahw</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax1</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">ind</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">clpropsw</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">xy_ahk</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax1</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">ind</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">clpropsk</span><span class="p">)</span>

        <span class="c1"># Draw X-slice intersection in Z-Y plot</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">zy_ahw</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax3</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">ind</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">clpropsw</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">zy_ahk</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax3</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">ind</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">clpropsk</span><span class="p">)</span></div>

<div class="viewcode-block" id="Slicer.update_zy"><a class="viewcode-back" href="../../api/generated/discretize.View.Slicer.html#discretize.Slicer.update_zy">[docs]</a>    <span class="k">def</span> <span class="nf">update_zy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Update plot for change in X-index.&quot;&quot;&quot;</span>

        <span class="c1"># Clean up</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_clear_elements</span><span class="p">([</span><span class="s1">&#39;zy_pc&#39;</span><span class="p">,</span> <span class="s1">&#39;xz_avw&#39;</span><span class="p">,</span> <span class="s1">&#39;xz_avk&#39;</span><span class="p">,</span> <span class="s1">&#39;xy_avw&#39;</span><span class="p">,</span> <span class="s1">&#39;xy_avk&#39;</span><span class="p">])</span>

        <span class="c1"># Draw Z-Y slice</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">yx</span><span class="p">:</span>
            <span class="n">xdat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">flipud</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">v</span><span class="p">[:,</span> <span class="bp">self</span><span class="o">.</span><span class="n">yind</span><span class="p">,</span> <span class="p">:])</span>
            <span class="n">hor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">z</span>
            <span class="n">ver</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span>
            <span class="n">ind</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">yc</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">yind</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">xdat</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">v</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">xind</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:]</span>
            <span class="n">hor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">z</span>
            <span class="n">ver</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span>
            <span class="n">ind</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">xc</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">xind</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">zy_pc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax3</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">hor</span><span class="p">,</span> <span class="n">ver</span><span class="p">,</span> <span class="n">xdat</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">pc_props</span><span class="p">)</span>

        <span class="c1"># Draw Y-slice intersection in X-Y plot</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">xy_avw</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax1</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">ind</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">clpropsw</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">xy_avk</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax1</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">ind</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">clpropsk</span><span class="p">)</span>

        <span class="c1"># Draw Y-slice intersection in X-Z plot</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">xz_avw</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax2</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">ind</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">clpropsw</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">xz_avk</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax2</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">ind</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">clpropsk</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">_clear_elements</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">names</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Remove elements from list &lt;names&gt; from plot if they exists.&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">names</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">element</span><span class="p">):</span>
                <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">element</span><span class="p">)</span><span class="o">.</span><span class="n">remove</span><span class="p">()</span></div>
</pre></div>

           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
<div role="contentinfo">
    <a rel="license" href="http://creativecommons.org/licenses/by/4.0/" width="60px"; style="float:right;height:3em;line-height:3em;padding:10px 0 0 1em;">
        <img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by/4.0/88x31.png" />
    </a>
    2013-2019,
    <a href="http://simpeg.xyz">SimPEG Developers.</a><br />
    Except where noted, this work is licensed under a <br />
    <a rel="license" href="http://creativecommons.org/licenses/by/4.0/">
        Creative Commons Attribution 4.0 International License
    </a>
</div>
<br>
<div>
Built with
    <a href="http://sphinx-doc.org/">Sphinx</a>
    using a
    <a href="https://github.com/snide/sphinx_rtd_theme">theme</a>
    provided by
    <a href="https://readthedocs.org">Read the Docs</a>.
 </div>


</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>